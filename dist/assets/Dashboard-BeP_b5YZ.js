const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UnlockDayModal-Db57Je2Q.js","assets/index-DsdHBg-U.js","assets/index-1tAU2q6_.css","assets/Input-BD-Z2Ngj.js"])))=>i.map(i=>d[i]);
import{k as q,l as ne,n as oe,o as de,r as n,p as ce,j as e,q as k,m as xe,S as me,B as z,t as he,v as ue,w as pe,_ as fe}from"./index-DsdHBg-U.js";import{D as be,R as ge,a as ke,b as Ne,T as je,U as ye}from"./DateHeader-CAmhYlAv.js";import{L as ve,P as Y,a as $}from"./pen-JKY5Plvx.js";import{F as we}from"./TaskItem-B7aPF-1x.js";import"./Card-DtUqZoAj.js";import"./circle-check-big-B80IwwrU.js";import"./plus-cBJjSPzt.js";import"./trash-2-DICzYwzF.js";import"./circle-alert-BHdOkKb5.js";import"./smartphone-BZFU7knY.js";import"./star-CDoLCna1.js";import"./trending-up-m3FHMxxd.js";import"./award-BhVmpCr6.js";import"./bike-6kj2rTJj.js";import"./chevron-up-DJWfF3-T.js";import"./subMonths-f5MJYfpx.js";import"./isSameMonth-BRtUvzPP.js";const Se=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Oe=q("target",Se);const Ee=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],De=q("trophy",Ee),Me=n.lazy(()=>fe(()=>import("./UnlockDayModal-Db57Je2Q.js"),__vite__mapDeps([0,1,2,3]))),Je=()=>{const{dailyData:a,updateTaskStatus:W,updateHabit:J,updateAllTasks:Ce,isLocked:m,submitDay:K,unlockDay:Q}=ne(),{isPast:N}=oe(),j=de(),[X,y]=n.useState(!1),[Z,v]=n.useState(!1),[ee,b]=n.useState(!1),[h,R]=n.useState({current:0,longest:0,loading:!0});n.useEffect(()=>{if(!user)return;(async()=>{try{const s=await he.getCollection(`users/${user.uid}/days`,ue("date","desc"),pe(365)),l=r=>{if(!r.tasks||r.tasks.length===0)return!1;const o=r.tasks.filter(x=>x.status==="checked").length;return Math.round(o/r.tasks.length*100)===100};let i=0,c=0,p=0;const F=new Date().toISOString().split("T")[0],_=s.find(r=>r.date===F);_&&l(_)&&(i=1);const U=r=>{const o=new Date(r);return o.setDate(o.getDate()-1),o.toISOString().split("T")[0]};let g=U(F);for(;;){const r=s.find(o=>o.date===g||o.id===g);if(r&&l(r))i++,g=U(g);else break}const f=[...s].sort((r,o)=>r.date.localeCompare(o.date));if(f.length>0){let r=new Date(f[0].date);const o=new Date(f[f.length-1].date);let x=0;for(;r<=o;){const P=r.toISOString().split("T")[0],V=f.find(B=>B.date===P||B.id===P);V&&l(V)?x++:(c=Math.max(c,x),x=0),r.setDate(r.getDate()+1)}c=Math.max(c,x)}R({current:i,longest:c,loading:!1})}catch(s){console.error("Streak calc error:",s),R({current:0,longest:0,loading:!1})}})()},[user,a.tasks]);const[w,S]=n.useState({isOpen:!1,type:"success",category:""}),[H,te]=n.useState(!0),{tasks:I}=ce(),A=I.filter(t=>t.status!=="done").slice(0,3),O=new Date().getHours();let E="Good Morning";O>=12&&O<17?E="Good Afternoon":O>=17&&(E="Good Evening");const se=a.tasks.filter(t=>t.status==="checked").length,L=a.tasks.length,d=L>0?Math.round(se/L*100):0,D=I.filter(t=>t.status!=="done").length;let u="";if(d>=80&&(u="Finishing strong."),d===100&&(u="Discipline mastered."),D===0&&d===100&&(u="All systems go."),!a||!a.tasks)return e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx(ve,{className:"w-8 h-8 animate-spin text-primary-500"})});const G={"EARLY MORNING":a.tasks.filter(t=>t.category==="EARLY MORNING"),"BEFORE NOON":a.tasks.filter(t=>t.category==="BEFORE NOON"),"AFTER NOON":a.tasks.filter(t=>t.category==="AFTER NOON"),"EVE/NIGHT":a.tasks.filter(t=>t.category==="EVE/NIGHT"||t.category==="NIGHT")},M=n.useRef({});n.useEffect(()=>{if(!a?.tasks||N)return;const t={};if(Object.entries(G).forEach(([s,l])=>{if(l.length===0){t[s]="empty";return}const i=l.every(p=>p.status==="checked"),c=l.every(p=>p.status==="checked"||p.status==="missed");i?t[s]="success":c?t[s]="failed":t[s]="incomplete"}),H){M.current=t,te(!1);return}Object.entries(t).forEach(([s,l])=>{const i=M.current[s]||"incomplete";l!==i&&(i==="incomplete"&&l==="success"?S({isOpen:!0,type:"success",category:s}):i==="incomplete"&&l==="failed"&&S({isOpen:!0,type:"troll",category:s}))}),M.current=t},[a.tasks,N,H]);const ae=()=>y(!0),re=async t=>{await K(t),y(!1)},le=t=>{Q(t),b(!1)},[C,T]=n.useState("");n.useEffect(()=>{if(C)return;const t=new Date().getHours();let s="";t<8?s="EARLY MORNING":t<12?s="BEFORE NOON":t<17?s="AFTER NOON":s="EVE/NIGHT";const l=a.tasks.some(i=>s==="EVE/NIGHT"?i.category==="EVE/NIGHT"||i.category==="NIGHT":i.category===s);T(l?s:"EARLY MORNING")},[a.tasks,C]);const ie=t=>{T(s=>s===t?"":t)};return e.jsxs("div",{className:"pb-32 px-4 pt-4 space-y-6",children:[e.jsx("div",{className:"sticky top-[60px] z-20 bg-white/80 dark:bg-slate-950/80 backdrop-blur-md pt-1 pb-3 -mx-4 px-4 border-b border-transparent",children:e.jsx(be,{className:"mb-0"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-end justify-between px-1",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white tracking-tight",children:[E,", User"]}),u&&e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm font-medium",children:u})]}),e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Workspace"}),e.jsxs("div",{className:"text-lg font-semibold text-slate-700 dark:text-slate-200",children:[D," tasks left"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-3xl p-5 shadow-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-indigo-500/20 transition-all duration-1000",style:{width:`${d}%`}}),e.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:k("w-12 h-12 rounded-2xl flex items-center justify-center transition-colors",d===100?"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400":"bg-slate-100 text-indigo-600 dark:bg-slate-800 dark:text-indigo-400"),children:d===100?e.jsx(De,{className:"w-6 h-6"}):e.jsx(Oe,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-0.5",children:"Routine"}),e.jsxs("div",{className:"text-xl font-bold text-slate-900 dark:text-white leading-none",children:[d,"% ",e.jsx("span",{className:"text-sm font-medium text-slate-400 ml-1",children:"Complete"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"sm:hidden text-right mr-2",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Tasks"}),e.jsx("div",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:D})]}),e.jsx("button",{onClick:()=>v(!0),className:k("w-10 h-10 rounded-full flex items-center justify-center bg-slate-50 hover:bg-slate-100 dark:bg-slate-800 dark:hover:bg-slate-700 text-slate-500 transition-colors",m&&"hidden"),children:e.jsx(Y,{className:"w-4 h-4 stroke-[2]"})})]})]})]}),d===100&&e.jsxs(xe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-100 dark:border-emerald-900/30 rounded-xl p-3 flex items-center gap-3 text-emerald-700 dark:text-emerald-400",children:[e.jsx(me,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"All daily routines completed. Excellent discipline."})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:k("p-2 rounded-lg",h.current>0?"bg-orange-100 text-orange-600 dark:bg-orange-900/20 dark:text-orange-500":"bg-slate-200 text-slate-400 dark:bg-slate-800"),children:e.jsx(we,{className:k("w-5 h-5",h.current>0&&"fill-current")})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:[h.current," Day Streak"]}),e.jsxs("div",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wide",children:["Longest: ",h.longest]})]})]}),e.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 text-right",children:h.current>0?e.jsx("span",{className:"text-orange-600 dark:text-orange-500",children:"Streak continues."}):"Start a new streak today."})]})]}),e.jsx("div",{className:"space-y-2",children:a.tasks.length>0?Object.entries(G).map(([t,s])=>e.jsx(ge,{title:t,tasks:s,onUpdateStatus:W,isLocked:m,isOpen:C===t,onToggle:()=>ie(t)},t)):m?e.jsxs("button",{onClick:()=>b(!0),className:"w-full py-12 border-2 border-dashed border-slate-200 dark:border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-400 hover:text-amber-500 hover:border-amber-200 dark:hover:border-amber-900/50 hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-all group",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-50 dark:bg-amber-900/20 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:e.jsx($,{className:"w-6 h-6 text-amber-500"})}),e.jsx("span",{className:"font-semibold text-sm text-slate-600 dark:text-slate-300",children:"Day Locked"}),e.jsx("span",{className:"text-xs mt-1",children:"Unlock availability to add routines"})]}):e.jsxs("button",{onClick:()=>v(!0),className:"w-full py-12 border-2 border-dashed border-slate-200 dark:border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-400 hover:text-indigo-500 hover:border-indigo-200 dark:hover:border-indigo-900/50 hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-all group",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:e.jsx(Y,{className:"w-6 h-6"})}),e.jsx("span",{className:"font-semibold text-sm",children:"Design Your Day"}),e.jsx("span",{className:"text-xs mt-1",children:"Add your daily rituals & routines"})]})}),e.jsx(ke,{habits:a.habits,onUpdateHabit:J,isLocked:m}),A.length>0&&e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[e.jsx("h3",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Priority Tasks"}),e.jsx("button",{onClick:()=>j("/workspace"),className:"text-[11px] font-bold text-indigo-500 hover:text-indigo-600",children:"VIEW ALL"})]}),e.jsx("div",{className:"space-y-2",children:A.map(t=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 p-3 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.priority==="High"?"bg-red-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:t.name})]}),e.jsx("span",{className:"text-xs text-slate-400",children:t.time||"Today"})]},t.id))})]}),e.jsx("div",{className:"pt-6",children:m?e.jsxs("div",{className:"text-center p-6 bg-slate-50 dark:bg-slate-900/50 rounded-2xl border border-slate-200 dark:border-slate-800/50 dashed",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 mb-4",children:[e.jsx($,{className:"w-6 h-6 text-slate-400"}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Day Completed & Locked"})]}),a.locked&&!N&&e.jsx(z,{variant:"outline",onClick:()=>b(!0),className:"w-full sm:w-auto text-xs h-9",children:"Unlock to Edit"})]}):e.jsx(z,{className:"w-full py-4 text-base font-semibold shadow-xl shadow-indigo-500/20",onClick:ae,children:"Complete Day"})}),e.jsx(Ne,{isOpen:X,onClose:()=>y(!1),data:a,onConfirm:re}),e.jsx(je,{isOpen:Z,onClose:()=>v(!1),tasks:a.tasks}),e.jsx(ye,{isOpen:w.isOpen,onClose:()=>S(t=>({...t,isOpen:!1})),type:w.type,category:w.category}),e.jsx(n.Suspense,{fallback:null,children:e.jsx(Me,{isOpen:ee,onClose:()=>b(!1),onConfirm:le})}),e.jsxs("div",{className:"flex justify-center gap-6 opacity-40 pt-8 pb-4",children:[e.jsx("button",{onClick:()=>j("/history"),className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"History"}),e.jsx("div",{className:"w-px h-3 bg-slate-300 my-auto"}),e.jsx("button",{onClick:()=>j("/settings"),className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"Settings"})]})]})};export{Je as default};
