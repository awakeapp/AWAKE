import{z as j,a1 as N,f as k,o as v,r as d,ab as w,ap as m,j as e,V as C,Q as y,J as E,ah as D}from"./index-DgPxFht0.js";import{u as L}from"./useThemeColor-C3OCr0DB.js";import{C as u}from"./credit-card-N7L52TBT.js";import{d as M}from"./differenceInDays-C6uvXbHI.js";const V=()=>{const c=j(),{isDark:b}=N();L(b?"#000000":"#F2F2F7");const{user:o}=k(),{accounts:I}=v(),[r,h]=d.useState([]),[g,x]=d.useState(!0);d.useEffect(()=>{if(!o?.uid)return;x(!0);const t=w.subscribeToCollection(`users/${o.uid}/vehicleLoans`,s=>{h(s||[]),x(!1)});return()=>t()},[o?.uid]);const a=d.useMemo(()=>{let t=0,s=0,i=0;const l=new Date;for(const n of r)t+=Number(n.emiAmount||0),s+=Number(n.remainingPrincipal||0),n.nextDueDate&&m(new Date(n.nextDueDate),l)&&i++;return{totalEMI:t,totalOutstanding:s,overdueCount:i,totalLoans:r.length}},[r]),p=t=>Number(t.remainingPrincipal)<=0?{label:"Cleared",color:"text-emerald-500",bg:"bg-emerald-50 dark:bg-emerald-900/20"}:t.nextDueDate&&m(new Date(t.nextDueDate),new Date)?{label:"Overdue",color:"text-rose-500",bg:"bg-rose-50 dark:bg-rose-900/20"}:{label:"Active",color:"text-indigo-500",bg:"bg-indigo-50 dark:bg-indigo-900/20"},f=t=>{if(!t.nextDueDate)return"";const s=M(new Date(t.nextDueDate),new Date);return s<0?`${Math.abs(s)}d overdue`:s===0?"Due today":`${s}d left`};return e.jsx(C,{header:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>c(-1),className:"p-2 -ml-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition-colors",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-xl font-bold tracking-tight text-slate-900 dark:text-white",children:"EMI Manager"})]}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-[#1C1C1E] rounded-2xl p-4 border border-slate-200 dark:border-[#2C2C2E]",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Monthly EMI"}),e.jsxs("p",{className:"text-2xl font-black text-slate-900 dark:text-white",children:["₹",a.totalEMI.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1C1C1E] rounded-2xl p-4 border border-slate-200 dark:border-[#2C2C2E]",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Outstanding"}),e.jsxs("p",{className:"text-2xl font-black text-rose-500",children:["₹",a.totalOutstanding.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1C1C1E] rounded-2xl p-4 border border-slate-200 dark:border-[#2C2C2E]",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Active Loans"}),e.jsx("p",{className:"text-2xl font-black text-indigo-500",children:a.totalLoans})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1C1C1E] rounded-2xl p-4 border border-slate-200 dark:border-[#2C2C2E]",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Overdue"}),e.jsx("p",{className:`text-2xl font-black ${a.overdueCount>0?"text-rose-500":"text-emerald-500"}`,children:a.overdueCount>0?a.overdueCount:"✓"})]})]}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-500/10 border border-indigo-100 dark:border-indigo-500/20 rounded-2xl p-4 mb-6 flex items-start gap-3",children:[e.jsx(y,{className:"w-5 h-5 text-indigo-500 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[13px] font-bold text-indigo-900 dark:text-indigo-300",children:"Synced with Vehicle Module"}),e.jsx("p",{className:"text-[12px] text-indigo-700/70 dark:text-indigo-400/60 mt-0.5",children:"EMI data is automatically synced from your Vehicle loans. Any changes made in Vehicle → Loans will reflect here instantly."})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-[13px] font-semibold text-slate-500 dark:text-[#8E8E93] uppercase tracking-wider px-1 mb-3",children:"Your Loans"})}),g?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"w-8 h-8 border-4 border-indigo-200 border-t-indigo-500 rounded-full animate-spin"})}):r.length===0?e.jsxs("div",{className:"text-center py-16 bg-white dark:bg-[#1C1C1E] rounded-2xl border border-slate-200 dark:border-[#2C2C2E]",children:[e.jsx(u,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-900 dark:text-white font-bold mb-1",children:"No EMI Loans Found"}),e.jsx("p",{className:"text-[13px] text-slate-500 max-w-[240px] mx-auto mb-6",children:"Add a vehicle loan in the Vehicle module to see your EMI details here."}),e.jsx("button",{onClick:()=>c("/vehicle"),className:"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400 px-6 py-2.5 rounded-xl font-bold text-sm active:scale-95 transition-all",children:"Go to Vehicle Module"})]}):e.jsx("div",{className:"space-y-3",children:r.map(t=>{const s=p(t),i=f(t),l=t.loanAmount>0?Math.round((t.loanAmount-t.remainingPrincipal)/t.loanAmount*100):0;return e.jsxs("div",{className:"bg-white dark:bg-[#1C1C1E] rounded-2xl p-5 border border-slate-200 dark:border-[#2C2C2E] active:scale-[0.98] transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${s.bg}`,children:e.jsx(u,{className:`w-5 h-5 ${s.color}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-[16px] font-bold text-slate-900 dark:text-white",children:t.lender||"Loan"}),e.jsx("p",{className:"text-[12px] text-slate-500 mt-0.5",children:t.vehicleName||"Vehicle"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-2.5 py-1 rounded-lg ${s.bg} ${s.color}`,children:s.label}),i&&e.jsxs("p",{className:"text-[11px] text-slate-400 mt-1.5 flex items-center justify-end gap-1",children:[e.jsx(E,{className:"w-3 h-3"})," ",i]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:"EMI"}),e.jsxs("p",{className:"text-[15px] font-bold text-slate-900 dark:text-white",children:["₹",Number(t.emiAmount||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:"Remaining"}),e.jsxs("p",{className:"text-[15px] font-bold text-rose-500",children:["₹",Number(t.remainingPrincipal||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:"Rate"}),e.jsxs("p",{className:"text-[15px] font-bold text-slate-900 dark:text-white",children:[t.interestRate||"—","%"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400",children:"Repayment Progress"}),e.jsxs("p",{className:"text-[10px] font-black text-indigo-500",children:[l,"%"]})]}),e.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-indigo-600 rounded-full transition-all duration-500",style:{width:`${l}%`}})})]})]},t.id)})})]})})};export{V as default};
