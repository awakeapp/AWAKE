import{i as V,k as B,l as P,r as i,n as Y,j as e,o as y,B as v}from"./index-D2dhrI06.js";import{D as z,R as W,a as $,b as q,T as J,U as K,c as Q}from"./UnlockDayModal-Bg9P4g7P.js";import{L as X,P as w,a as O}from"./pen-HTFr2WeX.js";import{C as Z}from"./circle-check-D4fhTVqY.js";import"./TaskItem-9twELoyT.js";import"./check-BSWKSJBS.js";import"./bike-BTOCNXoP.js";import"./trash-2-CDmjoKQg.js";import"./circle-check-big-DwTlzGT_.js";import"./chevron-up-DucM41_0.js";import"./subMonths-DgW2MR7g.js";import"./isSameMonth-C2to2zAa.js";import"./Card-CZNk89y4.js";import"./index-DOiIOaCS.js";import"./plus-D4_9nUSd.js";import"./circle-alert-BoN1vF-0.js";import"./smartphone-Jpt8U-Ze.js";import"./star-ChOtgXYO.js";import"./trending-up-D5-Ts_9U.js";import"./award-C14t_Rxa.js";import"./Input-CdaVv_Ia.js";const je=()=>{const{dailyData:a,updateTaskStatus:E,updateHabit:C,updateAllTasks:_,isLocked:o,submitDay:T,unlockDay:M}=V(),{isPast:c}=B(),m=P(),[R,x]=i.useState(!1),[S,p]=i.useState(!1),[D,n]=i.useState(!1),[u,h]=i.useState({isOpen:!1,type:"success",category:""}),[N,I]=i.useState(!0),{tasks:H}=Y(),g=H.filter(s=>s.status!=="done").slice(0,3);if(!a||!a.tasks)return e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx(X,{className:"w-8 h-8 animate-spin text-primary-500"})});const j={"EARLY MORNING":a.tasks.filter(s=>s.category==="EARLY MORNING"),"BEFORE NOON":a.tasks.filter(s=>s.category==="BEFORE NOON"),"AFTER NOON":a.tasks.filter(s=>s.category==="AFTER NOON"),"EVE/NIGHT":a.tasks.filter(s=>s.category==="EVE/NIGHT"||s.category==="NIGHT")},b=i.useRef({});i.useEffect(()=>{if(!a?.tasks||c)return;const s={};if(Object.entries(j).forEach(([t,r])=>{if(r.length===0){s[t]="empty";return}const l=r.every(d=>d.status==="checked"),F=r.every(d=>d.status==="checked"||d.status==="missed");l?s[t]="success":F?s[t]="failed":s[t]="incomplete"}),N){b.current=s,I(!1);return}Object.entries(s).forEach(([t,r])=>{const l=b.current[t]||"incomplete";r!==l&&(l==="incomplete"&&r==="success"?h({isOpen:!0,type:"success",category:t}):l==="incomplete"&&r==="failed"&&h({isOpen:!0,type:"troll",category:t}))}),b.current=s},[a.tasks,c,N]);const L=()=>x(!0),A=async s=>{await T(s),x(!1)},G=s=>{M(s),n(!1)},[f,k]=i.useState("");i.useEffect(()=>{if(f)return;const s=new Date().getHours();let t="";s<8?t="EARLY MORNING":s<12?t="BEFORE NOON":s<17?t="AFTER NOON":t="EVE/NIGHT";const r=a.tasks.some(l=>t==="EVE/NIGHT"?l.category==="EVE/NIGHT"||l.category==="NIGHT":l.category===t);k(r?t:"EARLY MORNING")},[a.tasks,f]);const U=s=>{k(t=>t===s?"":s)};return e.jsxs("div",{className:"pb-32 px-4 pt-4 space-y-6",children:[e.jsx("div",{className:"sticky top-[60px] z-20 bg-white/80 dark:bg-slate-950/80 backdrop-blur-md pt-1 pb-3 -mx-4 px-4 border-b border-transparent",children:e.jsx(z,{className:"mb-0"})}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl px-5 py-4 flex items-center justify-between shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:y("p-2.5 rounded-xl",a.tasks.every(s=>s.status==="checked")?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-500 dark:bg-slate-800"),children:e.jsx(Z,{className:"w-5 h-5 stroke-[1.5]"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-[15px] font-semibold text-slate-700 dark:text-slate-200 tracking-tight",children:"Today's Discipline"}),e.jsxs("p",{className:"text-[11px] text-slate-400 font-medium mt-0.5",children:[a.tasks.filter(s=>s.status==="checked").length,"/",a.tasks.length," Routine Steps"]})]})]}),e.jsx("button",{onClick:()=>p(!0),className:y("text-slate-400 hover:text-indigo-600 transition-colors p-2",o&&"hidden"),children:e.jsx(w,{className:"w-4 h-4 stroke-[1.5]"})})]}),e.jsx("div",{className:"space-y-2",children:a.tasks.length>0?Object.entries(j).map(([s,t])=>e.jsx(W,{title:s,tasks:t,onUpdateStatus:E,isLocked:o,isOpen:f===s,onToggle:()=>U(s)},s)):o?e.jsxs("button",{onClick:()=>n(!0),className:"w-full py-12 border-2 border-dashed border-slate-200 dark:border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-400 hover:text-amber-500 hover:border-amber-200 dark:hover:border-amber-900/50 hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-all group",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-50 dark:bg-amber-900/20 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:e.jsx(O,{className:"w-6 h-6 text-amber-500"})}),e.jsx("span",{className:"font-semibold text-sm text-slate-600 dark:text-slate-300",children:"Day Locked"}),e.jsx("span",{className:"text-xs mt-1",children:"Unlock availability to add routines"})]}):e.jsxs("button",{onClick:()=>p(!0),className:"w-full py-12 border-2 border-dashed border-slate-200 dark:border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-400 hover:text-indigo-500 hover:border-indigo-200 dark:hover:border-indigo-900/50 hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-all group",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",children:e.jsx(w,{className:"w-6 h-6"})}),e.jsx("span",{className:"font-semibold text-sm",children:"Design Your Day"}),e.jsx("span",{className:"text-xs mt-1",children:"Add your daily rituals & routines"})]})}),e.jsx($,{habits:a.habits,onUpdateHabit:C,isLocked:o}),g.length>0&&e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[e.jsx("h3",{className:"text-[11px] font-bold text-slate-400 uppercase tracking-widest",children:"Priority Tasks"}),e.jsx("button",{onClick:()=>m("/workspace"),className:"text-[11px] font-bold text-indigo-500 hover:text-indigo-600",children:"VIEW ALL"})]}),e.jsx("div",{className:"space-y-2",children:g.map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 p-3 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s.priority==="High"?"bg-red-500":"bg-slate-300"}`}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:s.name})]}),e.jsx("span",{className:"text-xs text-slate-400",children:s.time||"Today"})]},s.id))})]}),e.jsx("div",{className:"pt-6",children:o?e.jsxs("div",{className:"text-center p-6 bg-slate-50 dark:bg-slate-900/50 rounded-2xl border border-slate-200 dark:border-slate-800/50 dashed",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 mb-4",children:[e.jsx(O,{className:"w-6 h-6 text-slate-400"}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Day Completed & Locked"})]}),a.locked&&!c&&e.jsx(v,{variant:"outline",onClick:()=>n(!0),className:"w-full sm:w-auto text-xs h-9",children:"Unlock to Edit"})]}):e.jsx(v,{className:"w-full py-4 text-base font-semibold shadow-xl shadow-indigo-500/20",onClick:L,children:"Complete Day"})}),e.jsx(q,{isOpen:R,onClose:()=>x(!1),data:a,onConfirm:A}),e.jsx(J,{isOpen:S,onClose:()=>p(!1),tasks:a.tasks}),e.jsx(K,{isOpen:u.isOpen,onClose:()=>h(s=>({...s,isOpen:!1})),type:u.type,category:u.category}),e.jsx(Q,{isOpen:D,onClose:()=>n(!1),onConfirm:G}),e.jsxs("div",{className:"flex justify-center gap-6 opacity-40 pt-8 pb-4",children:[e.jsx("button",{onClick:()=>m("/history"),className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"History"}),e.jsx("div",{className:"w-px h-3 bg-slate-300 my-auto"}),e.jsx("button",{onClick:()=>m("/settings"),className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"Settings"})]})]})};export{je as default};
