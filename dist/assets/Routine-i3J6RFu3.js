const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UnlockDayModal-Ro8-4bZw.js","assets/index-Dni63RkL.js","assets/index-CZam1utS.css","assets/AppInput-CvkiCkqY.js"])))=>i.map(i=>d[i]);
import{o as D,p as T,g as I,r as i,j as s,y as L,k,_ as A}from"./index-Dni63RkL.js";import{R as H,a as F,D as U,L as _,b as G,T as P,U as B}from"./RoutineHeader-B0-joopV.js";import{P as V}from"./pen-Ci2c5G87.js";import"./TaskItem-BmhovZJU.js";import"./sun-dtd1KfjJ.js";import"./book-open--PJZsoqD.js";import"./bike-CjfyugEC.js";import"./trash-2-MMtH6vPd.js";import"./clock-BJ1gEYRg.js";import"./chevron-down-C8rsnSas.js";import"./chevron-up-DVJoFCMo.js";import"./subMonths-ypCLOBVC.js";import"./isSameMonth-EKRYgKGW.js";import"./utils-DayBekdl.js";import"./AppCard-DpTu2wkq.js";import"./index-CRWOlv-H.js";import"./plus-C4dEmhiS.js";import"./circle-check-CFvjP0eO.js";import"./circle-alert-DjndCTas.js";import"./smartphone-CBY9Vp78.js";import"./star-CUuq1UPs.js";import"./trending-up-CtWGxLuU.js";import"./award-DlmZ_SXq.js";const Y=i.lazy(()=>A(()=>import("./UnlockDayModal-Ro8-4bZw.js"),__vite__mapDeps([0,1,2,3]))),Ne=()=>{const{dailyData:t,updateTaskStatus:b,updateHabit:O,updateAllTasks:z,isLocked:r,submitDay:y,unlockDay:j}=D(),{isPast:c}=T();I();const[E,d]=i.useState(!1),[v,x]=i.useState(!1),[R,p]=i.useState(!1),[q,J]=i.useState({"EARLY MORNING":!0,"BEFORE NOON":!0,"AFTER NOON":!0,"EVE/NIGHT":!0}),[m,u]=i.useState({isOpen:!1,type:"success",category:""}),[h,g]=i.useState(!0);if(!t||!t.tasks)return s.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:s.jsx(L,{className:"w-8 h-8 animate-spin text-primary-500"})});const N={"EARLY MORNING":t.tasks.filter(e=>e.category==="EARLY MORNING"),"BEFORE NOON":t.tasks.filter(e=>e.category==="BEFORE NOON"),"AFTER NOON":t.tasks.filter(e=>e.category==="AFTER NOON"),"EVE/NIGHT":t.tasks.filter(e=>e.category==="EVE/NIGHT"||e.category==="NIGHT")},f=i.useRef({});i.useEffect(()=>{if(!t?.tasks||c)return;const e={};if(Object.entries(N).forEach(([a,o])=>{if(o.length===0){e[a]="empty";return}const l=o.every(n=>n.status==="checked"),w=o.every(n=>n.status==="checked"||n.status==="missed");l?e[a]="success":w?e[a]="failed":e[a]="incomplete"}),h){f.current=e,g(!1);return}Object.entries(e).forEach(([a,o])=>{const l=f.current[a]||"incomplete";o!==l&&(l==="incomplete"&&o==="success"?u({isOpen:!0,type:"success",category:a}):l==="incomplete"&&o==="failed"&&u({isOpen:!0,type:"troll",category:a}))}),f.current=e},[t.tasks,c,h]);const M=()=>{d(!0)},S=async e=>{await y(e),d(!1)},C=e=>{j(e),p(!1)};return s.jsxs("div",{className:"pb-24",children:[s.jsx("div",{className:"sticky top-[env(safe-area-inset-top)] z-40 pt-2 pb-3 mb-4 -mx-4 px-4",children:s.jsx(H,{onEditClick:()=>x(!0),isLocked:r})}),s.jsxs("div",{className:"space-y-6",children:[Object.entries(N).map(([e,a])=>s.jsx(F,{title:e,tasks:a,onUpdateStatus:b,isLocked:r},e)),s.jsx(U,{habits:t.habits,onUpdateHabit:O,isLocked:r}),r?s.jsxs("div",{className:"text-center p-6 bg-slate-100 rounded dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:[s.jsxs("div",{className:"flex flex-col items-center gap-2 mb-4",children:[s.jsx("div",{className:"bg-slate-200 p-4 rounded-full dark:bg-slate-800",children:s.jsx(_,{className:"w-8 h-8 text-slate-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-slate-700 dark:text-slate-300",children:"Day Locked"}),s.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"This day is completed and read-only."})]})]}),t.locked&&!c&&s.jsxs(k,{variant:"outline",onClick:()=>p(!0),className:"w-full sm:w-auto",children:[s.jsx(V,{className:"w-4 h-4 mr-2"}),"Edit Day"]})]}):s.jsx(k,{className:"w-full py-4 text-base font-semibold transition-all duration-150 active:scale-[0.98]",onClick:M,children:"Complete Day"})]}),s.jsx(G,{isOpen:E,onClose:()=>d(!1),data:t,onConfirm:S}),s.jsx(P,{isOpen:v,onClose:()=>x(!1),tasks:t.tasks}),s.jsx(B,{isOpen:m.isOpen,onClose:()=>u(e=>({...e,isOpen:!1})),type:m.type,category:m.category}),s.jsx(i.Suspense,{fallback:null,children:s.jsx(Y,{isOpen:R,onClose:()=>p(!1),onConfirm:C})})]})};export{Ne as default};
