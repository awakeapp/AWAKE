import{c as A,g as F,r as u,h as O,n as E,a8 as C,j as e,a9 as G,A as S,m as k,k as M,y as I,a6 as L}from"./index-Dni63RkL.js";import{A as D,a as P}from"./AppCard-DpTu2wkq.js";import{A as _}from"./arrow-left-BW-eLmrt.js";import{C as T}from"./circle-alert-DjndCTas.js";import{C as V}from"./chevron-up-DVJoFCMo.js";import{C as U}from"./chevron-down-C8rsnSas.js";const $=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],q=A("droplets",$);const z=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],H=A("rotate-ccw",z),y={breakfast:[{name:"Puttu (1 piece) & Kadala Curry",calories:350,protein:12,type:"veg"},{name:"Appam (2 nos) & Veg Stew",calories:320,protein:6,type:"veg"},{name:"Appam (2 nos) & Egg Roast",calories:380,protein:14,type:"non-veg"},{name:"Idli (3 nos) & Sambar",calories:300,protein:10,type:"veg"},{name:"Dosa (2 nos) & Chutney",calories:350,protein:8,type:"veg"},{name:"Upma (1 cup) & Banana",calories:300,protein:6,type:"veg"},{name:"Oats Upma with Veggies",calories:280,protein:10,type:"veg"},{name:"Wheat Puttu & Green Gram",calories:320,protein:14,type:"veg"}],lunch:[{name:"Matta Rice (1 cup), Thoran & Moru Curry",calories:450,protein:8,type:"veg"},{name:"Matta Rice (1 cup), Fish Curry & Thoran",calories:500,protein:25,type:"non-veg"},{name:"Curd Rice with Pickle",calories:350,protein:8,type:"veg"},{name:"Chicken Biryani (Small Portion)",calories:600,protein:25,type:"non-veg"},{name:"Veg Meals (Rice, Sambar, Avial)",calories:500,protein:12,type:"veg"},{name:"Ghee Rice & Chicken Roast (Small)",calories:650,protein:25,type:"non-veg"},{name:"Matta Rice & Omelette",calories:480,protein:15,type:"non-veg"}],dinner:[{name:"Chappathi (2 nos) & Veg Kurma",calories:350,protein:10,type:"veg"},{name:"Chappathi (2 nos) & Chicken Curry",calories:400,protein:20,type:"non-veg"},{name:"Kanji & Payar (Green Gram)",calories:320,protein:12,type:"veg"},{name:"Wheat Dosa (2 nos) & Chutney",calories:300,protein:8,type:"veg"},{name:"Grilled Fish & Salad",calories:350,protein:30,type:"non-veg"},{name:"Fruit Salad & Nuts",calories:250,protein:5,type:"veg"}],snacks:[{name:"Tea (Suggestion: No Sugar) & 2 Biscuits",calories:120,protein:2,type:"veg"},{name:"Coffee (Black/Low Sugar)",calories:30,protein:0,type:"veg"},{name:"Banana (Small)",calories:90,protein:1,type:"veg"},{name:"Handful of Peanuts",calories:160,protein:7,type:"veg"},{name:"Buttermilk (Sambharam)",calories:60,protein:2,type:"veg"}]},K=(n,i,r,c,h)=>{let t=10*i+6.25*r-5*n+5;return c==="female"&&(t=10*i+6.25*r-5*n-161),Math.round(t*({sedentary:1.2,light:1.375,moderate:1.55,active:1.725,very_active:1.9}[h]||1.2))},W=(n,i)=>{const r=Math.round(i*1.6),c=Math.round(n*.25/9),h=Math.round((n-r*4-c*9)/4);return{protein:r,fats:c,carbs:h}},J=["Idli / Dosa (Good Carbs)","Sambar with Drumsticks (Fiber & Protein)","Ragi Mudde (Calcium & Iron)","Chickpea Sundal (Protein Snack)","Curd Rice (Gut Health)"],Q=["Deep Fried Bajjis/Bondas","Sugary Mysore Pak (Limit intake)","Processed Maida Parottas","Excess White Rice at night"],X=(n,i,r,c)=>{let t=n-({slow:250,normal:500,fast:750}[r]||500);const x=1200;t<x&&(t=x);const p=Math.round(i*.035*10)/10,j=W(t,i),g=[];for(let b=1;b<=7;b++){const o=w=>c==="veg"?w.filter(B=>B.type==="veg"):w,a=o(y.breakfast),d=o(y.lunch),f=o(y.dinner),v=o(y.snacks),s=a[Math.floor(Math.random()*a.length)],l=d[Math.floor(Math.random()*d.length)],m=f[Math.floor(Math.random()*f.length)],N=v[Math.floor(Math.random()*v.length)],R=s.calories+l.calories+m.calories+N.calories;g.push({day:`Day ${b}`,meals:{breakfast:s,lunch:l,dinner:m,snack:N},totalCalories:R,targetCalories:t})}return{tdee:n,targetCalories:t,waterIntake:p,macros:j,weeklyPlan:g}},le=()=>{const n=F(),[i,r]=u.useState("input"),[c,h]=u.useState(!1),[t,x]=u.useState({age:"",weight:"",height:"",gender:"male",activity:"sedentary",preference:"non-veg",goalSpeed:"normal"}),[p,j]=u.useState(null),[g,b]=u.useState(null),{user:o}=O(),{t:a}=E();u.useEffect(()=>{if(!o)return;const s=C.subscribeToModule(o.uid,"diet",l=>{l&&l.plan&&(j(l.plan),r("plan"),l.profile&&x(m=>({...m,...l.profile})))});return()=>s()},[o]);const d=s=>{const{name:l,value:m}=s.target;x(N=>({...N,[l]:m}))},f=async s=>{s&&s.preventDefault&&s.preventDefault(),h(!0);try{const l=K(t.age,t.weight,t.height,t.gender,t.activity),m=X(l,t.weight,t.goalSpeed,t.preference);j(m),r("plan"),o&&await C.saveModule(o.uid,"diet",{plan:m,profile:t,updatedAt:new Date().toISOString()})}catch(l){console.error("Failed to save diet plan:",l),alert("Failed to save. Please try again.")}finally{h(!1)}},v=s=>{b(g===s?null:s)};return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 pb-16",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 shadow-sm px-4 pt-[calc(env(safe-area-inset-top)+1rem)] pb-4 sticky top-0 z-10 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>i==="plan"?r("input"):n("/"),className:"p-2 -ml-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-full",children:e.jsx(_,{className:"w-5 h-5 text-slate-600 dark:text-slate-300"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-orange-100 dark:bg-orange-900/30 p-2 rounded",children:e.jsx(G,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),e.jsx("h1",{className:"font-bold text-lg text-slate-800 dark:text-white",children:a("diet.title")})]})]}),e.jsx("main",{className:"p-4 max-w-lg mx-auto",children:e.jsx(S,{mode:"wait",children:i==="input"?e.jsxs(k.form,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",onSubmit:f,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-200",children:a("diet.tellUs")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:a("diet.age")}),e.jsx("input",{type:"number",name:"age",required:!0,value:t.age,onChange:d,className:"w-full p-3 rounded border border-slate-200 bg-white dark:bg-slate-800 dark:border-slate-700",placeholder:a("diet.age")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:a("diet.gender")}),e.jsxs("select",{name:"gender",value:t.gender,onChange:d,className:"w-full p-3 rounded border border-slate-200 bg-white dark:bg-slate-800 dark:border-slate-700",children:[e.jsx("option",{value:"male",children:a("diet.male")}),e.jsx("option",{value:"female",children:a("diet.female")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:a("diet.weight")}),e.jsx("input",{type:"number",name:"weight",required:!0,value:t.weight,onChange:d,className:"w-full p-3 rounded border border-slate-200 bg-white dark:bg-slate-800 dark:border-slate-700",placeholder:"kg"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:a("diet.height")}),e.jsx("input",{type:"number",name:"height",required:!0,value:t.height,onChange:d,className:"w-full p-3 rounded border border-slate-200 bg-white dark:bg-slate-800 dark:border-slate-700",placeholder:"cm"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:a("diet.activityLevel")}),e.jsxs("select",{name:"activity",value:t.activity,onChange:d,className:"w-full p-3 rounded border border-slate-200 bg-white dark:bg-slate-800 dark:border-slate-700",children:[e.jsx("option",{value:"sedentary",children:a("diet.sedentary")}),e.jsx("option",{value:"light",children:a("diet.light")}),e.jsx("option",{value:"moderate",children:a("diet.moderate")}),e.jsx("option",{value:"active",children:a("diet.active")})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:a("diet.foodPref")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{type:"button",onClick:()=>x({...t,preference:"veg"}),className:`p-3 rounded-xl border text-sm font-medium transition-all ${t.preference==="veg"?"bg-green-50 border-green-500 text-green-700 dark:bg-green-900/30 dark:text-green-300":"border-slate-200 dark:border-slate-700 text-slate-500"}`,children:a("diet.veg")}),e.jsx("button",{type:"button",onClick:()=>x({...t,preference:"non-veg"}),className:`p-3 rounded-xl border text-sm font-medium transition-all ${t.preference==="non-veg"?"bg-orange-50 border-orange-500 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300":"border-slate-200 dark:border-slate-700 text-slate-500"}`,children:a("diet.nonVeg")})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:a("diet.goalSpeed")}),e.jsxs("select",{name:"goalSpeed",value:t.goalSpeed,onChange:d,className:"w-full p-3 rounded border border-slate-200 bg-white dark:bg-slate-800 dark:border-slate-700",children:[e.jsx("option",{value:"slow",children:a("diet.slow")}),e.jsx("option",{value:"normal",children:a("diet.normal")}),e.jsx("option",{value:"fast",children:a("diet.fast")})]})]})]}),e.jsx(M,{disabled:c,className:"w-full py-4 text-lg shadow-md shadow-orange-500/20 bg-gradient-to-r from-orange-500 to-red-500 border-none disabled:opacity-50",children:c?e.jsx(I,{className:"w-6 h-6 animate-spin mx-auto"}):a("diet.generate")})]},"input"):e.jsxs(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-900 to-slate-800 rounded p-6 text-white shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wider font-semibold",children:a("diet.dailyTarget")}),e.jsxs("h2",{className:"text-3xl font-black mt-1",children:[p?.targetCalories||"--"," ",e.jsx("span",{className:"text-lg font-medium text-slate-400",children:a("diet.kcal")})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-slate-400 text-xs uppercase tracking-wider font-semibold",children:a("diet.water")}),e.jsxs("div",{className:"flex items-center gap-1 justify-end mt-1 text-blue-300",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-xl font-bold",children:[p?.waterIntake||"--","L"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center text-xs",children:[e.jsxs("div",{className:"bg-white/10 p-2 rounded",children:[e.jsxs("span",{className:"block font-bold text-lg",children:[p?.macros?.protein||"--","g"]}),e.jsx("span",{className:"text-slate-400",children:a("diet.protein")})]}),e.jsxs("div",{className:"bg-white/10 p-2 rounded",children:[e.jsxs("span",{className:"block font-bold text-lg",children:[p?.macros?.carbs||"--","g"]}),e.jsx("span",{className:"text-slate-400",children:a("diet.carbs")})]}),e.jsxs("div",{className:"bg-white/10 p-2 rounded",children:[e.jsxs("span",{className:"block font-bold text-lg",children:[p?.macros?.fats||"--","g"]}),e.jsx("span",{className:"text-slate-400",children:a("diet.fats")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(D,{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-emerald-100",children:e.jsxs(P,{className:"p-4",children:[e.jsxs("h4",{className:"font-bold text-emerald-800 flex items-center gap-2 mb-3 text-sm uppercase tracking-wide",children:[e.jsx(L,{className:"w-4 h-4"}),a("diet.recommended")]}),e.jsx("ul",{className:"space-y-2",children:J.slice(0,3).map((s,l)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm text-emerald-700",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400"}),s]},l))})]})}),e.jsx(D,{className:"bg-red-50 border-red-100",children:e.jsxs(P,{className:"p-4",children:[e.jsxs("h4",{className:"font-bold text-red-800 flex items-center gap-2 mb-3 text-sm uppercase tracking-wide",children:[e.jsx(T,{className:"w-4 h-4"}),a("diet.avoid")]}),e.jsx("ul",{className:"space-y-2",children:Q.slice(0,3).map((s,l)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm text-red-700",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-400"}),s]},l))})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-200 mt-2",children:a("diet.weeklyPlan")}),p?.weeklyPlan?.map((s,l)=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded border border-slate-100 dark:border-slate-700 overflow-hidden shadow-sm",children:[e.jsxs("button",{onClick:()=>v(l),className:"w-full p-4 flex items-center justify-between text-left hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400 font-bold text-xs",children:s?.day?.split(" ")[1]||l+1}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-700 dark:text-slate-200",children:s?.day||`Day ${l+1}`}),e.jsxs("p",{className:"text-xs text-slate-400",children:[s?.totalCalories||"--"," ",a("diet.kcal")]})]})]}),g===l?e.jsx(V,{className:"w-5 h-5 text-slate-400"}):e.jsx(U,{className:"w-5 h-5 text-slate-400"})]}),e.jsx(S,{children:g===l&&e.jsx(k.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden bg-slate-50 dark:bg-slate-900/50",children:e.jsxs("div",{className:"p-4 pt-0 space-y-3 border-t border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"space-y-1 mt-3",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:a("diet.breakfast")}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:s?.meals?.breakfast?.name||"--"}),e.jsx("span",{className:"text-slate-400 font-mono text-xs",children:s?.meals?.breakfast?.calories||"--"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:a("diet.lunch")}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:s?.meals?.lunch?.name||"--"}),e.jsx("span",{className:"text-slate-400 font-mono text-xs",children:s?.meals?.lunch?.calories||"--"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:a("diet.dinner")}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:s?.meals?.dinner?.name||"--"}),e.jsx("span",{className:"text-slate-400 font-mono text-xs",children:s?.meals?.dinner?.calories||"--"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase",children:a("diet.snack")}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:s?.meals?.snack?.name||"--"}),e.jsx("span",{className:"text-slate-400 font-mono text-xs",children:s?.meals?.snack?.calories||"--"})]})]})]})})})]},l))]}),e.jsxs(M,{variant:"secondary",onClick:f,className:"w-full gap-2 border-orange-200 text-orange-700 hover:bg-orange-50 dark:border-orange-800 dark:text-orange-300 dark:hover:bg-orange-900/20",children:[e.jsx(H,{className:"w-4 h-4"}),a("diet.regenerate")]})]},"plan")})})]})};export{le as default};
