import{aI as $e,aA as aa,z as sa,o as la,q as ra,f as na,j as e,r as l,ap as ie,aj as c,as as oe,l as ia,aq as oa,V as da,C as Pe,S as ca,E as dt,A as de,m as S,X as ct,$ as xa,J as ma,W as pa,Z as ce,T as ua,ah as ba}from"./index-DgPxFht0.js";import ha from"./html2canvas.esm-DXEQVQnt.js";import{S as ga}from"./storageService-CkksshFt.js";import{D as xt}from"./DeleteConfirmationModal-CadwlCts.js";import{I as fa}from"./ItemMenu-CxMDzUDN.js";import{u as ya,S as wa}from"./useSelection-BZNpjxPS.js";import{T as ka}from"./triangle-alert-BosfxxC0.js";import{d as ja}from"./differenceInDays-C6uvXbHI.js";import{C as Na}from"./credit-card-N7L52TBT.js";import{M as mt,A as pt,a as ut,P as bt,b as va,I as Sa,S as Da}from"./send-BykFwN4o.js";import{P as Re}from"./plus-BoOHfWjy.js";import{C as Ca}from"./chevron-down-DxzefmtS.js";import{Z as ht}from"./zoom-in-Bu_eYU12.js";import{T as gt}from"./toggle-right-Cqqh_CAi.js";import{T as ft}from"./toggle-left-DphJsawq.js";import{W as Ma}from"./wallet-BOyL5lfP.js";import{F as _a}from"./file-text-B6YmjOty.js";import{R as Ta}from"./rotate-ccw-BRuvVwEv.js";import"./eye-C2e92q6p.js";import"./pen-D-4zrPxo.js";import"./square-check-big-CjtHy18m.js";import"./square-CRS1Gj_0.js";function Pa(p,D){const C=$e(p,D?.in);return C.setHours(23,59,59,999),C}function Ra(p,D){return+$e(p)>+$e(D)}const yt=[{id:"you_gave",label:"You Gave",color:"bg-red-50 text-red-600 dark:bg-red-500/10 dark:text-red-400",sign:"+"},{id:"you_received",label:"You Received",color:"bg-emerald-50 text-emerald-600 dark:bg-emerald-500/10 dark:text-emerald-400",sign:"-"},{id:"you_borrowed",label:"You Borrowed",color:"bg-red-50 text-red-600 dark:bg-red-500/10 dark:text-red-400",sign:"-"},{id:"you_repaid",label:"You Repaid",color:"bg-emerald-50 text-emerald-600 dark:bg-emerald-500/10 dark:text-emerald-400",sign:"+"},{id:"adjustment",label:"Adjustment",color:"bg-slate-50 text-slate-600 dark:bg-slate-500/10 dark:text-slate-400",sign:"Â±"},{id:"write_off",label:"Write-off",color:"bg-slate-50 text-slate-600 dark:bg-slate-500/10 dark:text-slate-400",sign:"0"}],wt={active:{label:"Active",cls:"bg-indigo-100 text-indigo-700 dark:bg-indigo-500/20 dark:text-indigo-300"},cleared:{label:"Cleared",cls:"bg-emerald-100 text-emerald-700 dark:bg-emerald-500/20 dark:text-emerald-300"},overdue:{label:"Overdue",cls:"bg-red-100 text-red-700 dark:bg-red-500/20 dark:text-red-300"}},$a=["All","Pending","Settled","Overdue"],ds=()=>{const{partyId:p}=aa(),D=sa(),C=la(),{showToast:j}=ra(),{user:H}=na();if(!C||!C.debtParties)return e.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-950 flex items-center justify-center p-6",children:e.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-200 dark:bg-slate-800 rounded-full mb-4"}),e.jsx("div",{className:"h-4 w-32 bg-slate-200 dark:bg-slate-800 rounded"})]})});const{debtParties:kt,getPartyTransactions:jt,getPartyBalance:Nt,addDebtTransaction:vt,softDeleteDebtTransaction:Ae,reverseDebtTransaction:Aa,isEntryLocked:St,getEntrySettledAmount:N,updateDebtParty:Oe,addTransaction:Dt,editDebtTransaction:Ct,getPartyStatus:Mt,getPendingEntries:_t,addSettlementPayment:Le,accounts:Ie,financeConfig:xe}=C,i=kt.find(t=>t.id===p&&!t.is_deleted);if(!i)return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-950 flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(ka,{className:"w-12 h-12 text-slate-400 mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"Party Not Found"}),e.jsx("p",{className:"text-slate-500 mb-6",children:"This party may have been deleted."}),e.jsx("button",{onClick:()=>D(-1),className:"px-6 py-2 bg-indigo-600 text-white rounded-xl font-bold",children:"Go Back"})]});const g=jt(p),u=Nt(p),me=u>0,Tt=Mt(p),Ee=wt[Tt]||wt.active,d=_t(p),A=l.useMemo(()=>{let t=0,a=0,s=0;const r=new Date;for(const o of g)if(o.type==="you_gave"||o.type==="you_borrowed"){const x=N(o.id),m=Number(o.amount)-x;m>0&&(o.type==="you_gave"&&(t+=m),o.type==="you_borrowed"&&(a+=m),o.due_date&&ie(new Date(o.due_date),r)&&(s+=m))}const n=g.length>0?g[0].date:null,k=i.last_reminder_sent_at||null;let b=null;for(const o of g)if((o.type==="you_gave"||o.type==="you_borrowed")&&o.due_date){const x=N(o.id);Number(o.amount)-x>0&&(!b||ie(new Date(o.due_date),new Date(b)))&&(b=o.due_date)}return{totalReceivable:t,totalPayable:a,overdueAmount:s,lastTxDate:n,lastReminder:k,oldestDueDate:b}},[g,i,N]),[O,Pt]=l.useState("All"),[L,Rt]=l.useState(""),[I,$t]=l.useState(""),[At,Fe]=l.useState(!1),[Ot,Ue]=l.useState(!1),[Be,E]=l.useState(!1),[M,K]=l.useState("you_gave"),[f,pe]=l.useState(""),[v,ue]=l.useState(c(new Date,"yyyy-MM-dd")),[y,J]=l.useState(c(oe(new Date,10),"yyyy-MM-dd")),[Z,be]=l.useState(""),[Lt,he]=l.useState(!1),[It,V]=l.useState(!1),[Et,We]=l.useState(!1),[ge,Ge]=l.useState(null),[F,X]=l.useState(null),[ze,fe]=l.useState(!1),Q=l.useRef(null),{isSelectionMode:ye,selectedIds:Ye,toggleSelection:Ft,enterSelectionMode:Ut,exitSelectionMode:qe,toggleSelectAll:Bt,count:He,isAllSelected:Wt}=ya(),Ke=t=>{ye||(Q.current=setTimeout(()=>{Ut(t),window.navigator&&window.navigator.vibrate&&window.navigator.vibrate(50)},500))},we=()=>{Q.current&&(clearTimeout(Q.current),Q.current=null)},[Je,ke]=l.useState(null),[_,je]=l.useState(null),[Ze,Ve]=l.useState(!1),[Xe,ee]=l.useState(null),Qe=l.useRef(null),[et,te]=l.useState(!1),[U,Gt]=l.useState(""),[w,tt]=l.useState(!0),[B,T]=l.useState({}),[W,at]=l.useState(""),[Ne,st]=l.useState(!1),[ae,G]=l.useState(!1),[Oa,La]=l.useState(!1),lt=i.phone_number&&u!==0,[h,rt]=l.useState(i.preferred_reminder_method||"whatsapp"),[z,ve]=l.useState("text");`${(i.country_code||"+91").replace("+","")}${i.phone_number||""}`;const[Se,nt]=l.useState(!1),De=l.useRef(null),[P,Ce]=l.useState([]);l.useEffect(()=>{ae&&Ce(d.map(t=>t.id))},[ae]);const Y=l.useMemo(()=>d.filter(t=>P.includes(t.id)),[d,P]),se=l.useMemo(()=>Y.reduce((t,a)=>t+a.remaining,0),[Y]),Me=l.useMemo(()=>{const t=se.toLocaleString(),a=h==="whatsapp",s=u>0,r=Y.map(x=>{const m=c(new Date(x.date),"dd MMM yyyy"),R=x.notes||"Entry",$=x.remaining.toLocaleString();return a?`${m} - ${R} - *â‚¹${$}*`:`${m} - ${R} - â‚¹${$}`}).join(`
`),n="------------------------",k=s?"Pending Payment Summary:":"Pending Repayment Summary:",b=s?"Kindly clear at earliest convenience.":"I will clear this at earliest convenience.";let o="";if(a?o=`Hi ${i.name},

${k}

${r}
${n}
*TOTAL: â‚¹${t}*
${n}

${b}`:o=`Hi ${i.name},
${k}
${r}
${n}
TOTAL: â‚¹${t}
${n}

${b}`,s&&xe?.upiId){let x=window.location.origin;x+="/AWAKE/".replace(/\/$/,"");const m=new URL(x+"/pay");m.searchParams.set("upi",xe.upiId),m.searchParams.set("am",se.toString()),m.searchParams.set("pn",H?.name||"AWAKE User"),o+=`

ðŸ’³ Pay instantly via UPI:
${m.toString()}`}return o},[i.name,se,Y,h,u,xe,H]),zt=()=>{G(!0)},[Ia,Ea]=l.useState(!1),Yt=(t,a)=>{const s=(t||"+91").replace(/[^+\d]/g,""),r=(a||"").replace(/[\s\-\(\)\.]/g,"");return`${s.replace("+","")}${r}`},it=()=>{if(!i.phone_number){alert("No phone number is attached to this party.");return}const t=Yt(i.country_code,i.phone_number),a=encodeURIComponent(Me);h==="whatsapp"?window.location.href=`https://wa.me/${t}?text=${a}`:window.location.href=`sms:${t}?body=${a}`,Oe(p,{last_reminder_sent_at:new Date().toISOString()}).catch(()=>{}),G(!1)},qt=async t=>{if(!i.phone_number){alert("No phone number is attached to this party.");return}let a=null;{nt(!0);try{if(De.current){const s=await ha(De.current,{scale:2,backgroundColor:"#0f172a"}),r=await new Promise(n=>s.toBlob(n,"image/jpeg",.9));a=new File([r],`${i.name.replace(/\\s+/g,"_")}_Overview.jpg`,{type:"image/jpeg"})}}catch{}nt(!1)}if(a)if(navigator.canShare&&navigator.canShare({files:[a]}))try{await navigator.share({files:[a],title:"Account Overview",text:Me})}catch{}else{const s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=a.name,r.click(),URL.revokeObjectURL(s),alert("Your device doesn't support direct file sharing. The image has been downloaded instead.")}else it();Oe(p,{last_reminder_sent_at:new Date().toISOString()}).catch(()=>{}),G(!1)},_e=l.useMemo(()=>A.lastReminder?ja(new Date,new Date(A.lastReminder)):null,[A.lastReminder]);ia(Be||et||ae||!!F||ze);const[Ht,Kt]=l.useState({}),Jt=t=>Kt(a=>({...a,[t]:!a[t]})),[Fa,Ua]=l.useState(null),le=M==="you_received"||M==="you_repaid",re=l.useMemo(()=>w?0:Object.values(B).reduce((t,a)=>t+(Number(a)||0),0),[B,w]),ot=l.useMemo(()=>d.reduce((t,a)=>t+a.remaining,0),[d]),ne=l.useMemo(()=>{const t=new Date;let a=[...g];if(L){const s=oa(new Date(L+"T00:00:00"));a=a.filter(r=>!ie(new Date(r.date),s))}if(I){const s=Pa(new Date(I+"T00:00:00"));a=a.filter(r=>!Ra(new Date(r.date),s))}if(O==="Pending"){const s=new Set(d.map(r=>r.id));a=a.filter(r=>s.has(r.id))}else O==="Settled"?a=a.filter(s=>s.type!=="you_gave"&&s.type!=="you_borrowed"?!1:N(s.id)>=Number(s.amount)):O==="Overdue"&&(a=a.filter(s=>{if(s.type!=="you_gave"&&s.type!=="you_borrowed")return!1;const r=N(s.id);return Number(s.amount)-r>0&&s.due_date&&ie(new Date(s.due_date),t)}));return a},[g,O,L,I,d,N]),Zt=l.useMemo(()=>{const t=[...g].sort((r,n)=>new Date(r.date).getTime()-new Date(n.date).getTime()),a={};let s=0;for(const r of t){const n=Number(r.amount);switch(r.type){case"you_gave":s+=n;break;case"you_received":s-=n;break;case"you_borrowed":s-=n;break;case"you_repaid":s+=n;break;case"adjustment":s+=n;break;case"write_off":s=0;break}a[r.id]=s}return a},[g]),Vt=async t=>{if(t.preventDefault(),!f||Number(f)<=0){j("Please enter a valid amount","error");return}if(!Z.trim()){j("Please provide a description","error");return}if(le&&d.length>0){Gt(f),E(!1),te(!0);return}fe(!0)},Xt=async()=>{try{let t=null;if(Je&&H){Ve(!0);try{const a=ge||`tx_${Date.now()}`,s=`users/${H.uid}/finance/receipts/${a}.jpg`,{url:r}=await ga.uploadImage(Je,s);t=r}catch{j("Receipt upload failed, saving without it.","warning")}finally{Ve(!1)}}ge?(await Ct(ge,{type:M,amount:Number(f),date:new Date(v+"T12:00:00").toISOString(),due_date:y?new Date(y+"T12:00:00").toISOString():null,notes:Z,...t&&{receipt_url:t}}),j("Entry updated","success")):(await vt({party_id:i.id,type:M,amount:Number(f),date:new Date(v+"T12:00:00").toISOString(),due_date:y?new Date(y+"T12:00:00").toISOString():null,notes:Z,...t&&{receipt_url:t}}),j("Entry saved","success")),q()}catch{j("Failed to save entry","error")}},Qt=async()=>{const t=Number(U);if(t<=0)return;const a=me?"you_received":"you_repaid";if(w)await Le(p,t,{settleOldestFirst:!0,txType:a,date:new Date(v+"T12:00:00").toISOString(),notes:W||"Payment â€” oldest first"});else{const s=Object.entries(B).filter(([,r])=>Number(r)>0).map(([r,n])=>({entry_id:r,amount:Number(n)}));await Le(p,t,{settleOldestFirst:!1,selectedEntries:s,txType:a,date:new Date(v+"T12:00:00").toISOString(),notes:W||"Payment â€” selected entries"})}if(Ne){const s=Ie.find(r=>!r.isArchived)||Ie[0];s&&await Dt({type:a==="you_received"?"income":"expense",amount:t,accountId:s.id,categoryId:"",date:new Date(v+"T12:00:00").toISOString(),note:`Debt Settlement: ${i.name}${W?` - ${W}`:""}`})}q(),te(!1),T({}),tt(!0),at(""),st(!1)},q=()=>{E(!1),pe(""),be(""),J(c(oe(new Date,10),"yyyy-MM-dd")),ue(c(new Date,"yyyy-MM-dd")),V(!1),We(!1),Ge(null),ke(null),_&&URL.revokeObjectURL(_),je(null)},ea=(t,a)=>{T(s=>{const r={...s};return r[t]!==void 0?delete r[t]:r[t]=String(a),r})};return e.jsxs(da,{headerBgClass:"bg-slate-50/80 dark:bg-slate-950/80",headerBorderClass:"border-none",headerPadClass:"p-0",header:e.jsxs("div",{className:"contents",children:[e.jsx(wa,{count:He,isAllSelected:Wt,onCancel:qe,onSelectAll:()=>Bt(ne.map(t=>t.id)),actions:[{label:"Delete",icon:e.jsx(ua,{className:"w-5 h-5"}),onClick:()=>X("bulk"),variant:"danger"}]}),e.jsxs("div",{className:"px-4 pt-4 pb-5 flex items-center justify-between border-b border-slate-200/30 dark:border-slate-800/30",children:[e.jsx("button",{onClick:()=>D(-1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors text-slate-900 dark:text-white -ml-1",children:e.jsx(ba,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex flex-col items-center flex-1 px-4 min-w-0",children:e.jsx("h1",{className:"text-xl font-black text-slate-900 dark:text-white truncate w-full text-center tracking-tight leading-tight capitalize",children:i.name})}),e.jsx("div",{className:`px-3 py-1.5 rounded-xl font-black uppercase tracking-widest text-[9px] shadow-sm shrink-0 ${Ee.cls}`,children:Ee.label})]})]}),renderFloating:e.jsxs(e.Fragment,{children:[e.jsx(xt,{isOpen:!!F,onClose:()=>X(null),onConfirm:async()=>{if(F==="bulk"){for(const t of Ye)await Ae(t);qe()}else await Ae(F);X(null),j("Entries removed","success")},isFinancial:!0,title:F==="bulk"?`Delete ${He} Entries?`:"Delete Entry?",message:"Are you sure you want to remove this ledger entry? This will impact the party balance."}),e.jsx(xt,{isOpen:ze,onClose:()=>fe(!1),onConfirm:async()=>{await Xt(),fe(!1)},isFinancial:!0,title:"Confirm Entry?",message:"Are you sure you want to save this financial entry? This will affect your debt balance.",confirmLabel:"Save Entry"})]}),children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-indigo-700 dark:from-indigo-600 dark:to-indigo-900 rounded-[2.5rem] p-7 text-white shadow-2xl shadow-indigo-500/20 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full blur-3xl -mr-10 -mt-10 pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-black/10 rounded-full blur-3xl -ml-10 -mb-10 pointer-events-none"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-200/80 mb-2 text-center",children:"Net Balance"}),e.jsxs("p",{className:`text-[44px] font-black tracking-tightest text-center mb-6 leading-none drop-shadow-md ${u>=0?"text-emerald-300":"text-rose-300"}`,children:[u>=0?"+":"-","â‚¹",Math.abs(u).toLocaleString()]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white/10 dark:bg-black/20 rounded-2xl p-4 backdrop-blur-md border border-white/10 text-center",children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-[0.15em] text-indigo-200/70 mb-1",children:"To Get"}),e.jsxs("p",{className:"text-sm font-black text-emerald-300",children:["â‚¹",A.totalReceivable.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white/10 dark:bg-black/20 rounded-2xl p-4 backdrop-blur-md border border-white/10 text-center",children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-[0.15em] text-indigo-200/70 mb-1",children:"To Pay"}),e.jsxs("p",{className:"text-sm font-black text-rose-300",children:["â‚¹",A.totalPayable.toLocaleString()]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u!==0&&e.jsxs("button",{onClick:()=>{K(me?"you_received":"you_repaid"),E(!0)},className:"flex-1 py-4 bg-indigo-600 text-white rounded-[1.5rem] font-black uppercase tracking-widest text-[10px] flex items-center justify-center gap-2 shadow-xl shadow-indigo-500/20 active:scale-[0.98] transition-all",children:[e.jsx(Na,{className:"w-4 h-4"})," Record Payment"]}),e.jsxs("button",{onClick:zt,disabled:!lt,className:`py-4 rounded-[1.5rem] font-black uppercase tracking-widest text-[10px] flex items-center justify-center gap-2 transition-all active:scale-[0.98] ${u!==0?"px-4":"flex-1 px-4"} ${lt?"bg-emerald-600 text-white shadow-xl shadow-emerald-500/20":"bg-slate-200 dark:bg-slate-800 text-slate-400 cursor-not-allowed"}`,children:[e.jsx(mt,{className:"w-4 h-4"}),u===0?"Settled":i.phone_number?"Remind":"No Phone"]})]}),_e!==null&&e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-wider text-center -mt-1 opacity-70",children:_e===0?"Reminder sent today":`Last reminder ${_e}d ago`}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar -mx-1 px-1",children:$a.map(t=>e.jsx("button",{onClick:()=>Pt(t),className:`px-3.5 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider whitespace-nowrap transition-colors ${O===t?"bg-indigo-600 text-white shadow-sm":"bg-white dark:bg-slate-900 text-slate-500 border border-slate-200 dark:border-slate-800"}`,children:t},t))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-black text-slate-900 dark:text-white text-base tracking-tight",children:["Ledger ",e.jsxs("span",{className:"text-slate-400 font-bold text-sm ml-1",children:["(",ne.length,")"]})]}),e.jsxs("button",{onClick:()=>E(!0),className:"text-white text-[11px] font-black flex items-center gap-1.5 bg-indigo-600 px-4 py-2 rounded-xl active:scale-95 transition-transform shadow-md shadow-indigo-500/20 uppercase tracking-wider",children:[e.jsx(Re,{className:"w-3.5 h-3.5"})," Entry"]})]}),e.jsx("div",{className:"space-y-2 pb-8",children:ne.length===0?e.jsx("div",{className:"text-center py-12 bg-white dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-800",children:e.jsx("p",{className:"text-slate-400 font-medium",children:"No entries match this filter."})}):ne.map(t=>{const a=St(t),s=yt.find(ta=>ta.id===t.type)||yt[0],r=t.is_reversal,n=t.type==="you_gave"||t.type==="you_borrowed",k=n?N(t.id):0,b=n?Number(t.amount)-k:0,o=t.settlements&&t.settlements.length>0,x=Zt[t.id],m=t.notes&&t.notes.length>0,R=Ht[t.id],$=t.type==="you_gave"||t.type==="you_repaid",Te=Ye.includes(t.id);return e.jsxs("div",{onClick:()=>ye&&Ft(t.id),onMouseDown:()=>Ke(t.id),onMouseUp:we,onMouseLeave:we,onTouchStart:()=>Ke(t.id),onTouchEnd:we,className:dt("bg-white dark:bg-slate-900 rounded-2xl border transition-all overflow-hidden cursor-pointer",Te?"border-indigo-500 ring-2 ring-indigo-500/20 dark:ring-indigo-500/40":"border-slate-100 dark:border-slate-800"),children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:dt("w-10 h-10 rounded-2xl flex items-center justify-center shrink-0 transition-colors",Te?"bg-indigo-600 text-white":s.color),children:Te?e.jsx(Pe,{className:"w-5 h-5"}):a?e.jsx(ca,{className:"w-4 h-4"}):$?e.jsx(pt,{className:"w-4 h-4"}):e.jsx(ut,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-sm leading-tight",children:s.label}),e.jsxs("p",{className:"text-[11px] text-slate-400 mt-0.5 flex items-center gap-1 flex-wrap",children:[c(new Date(t.date),"dd MMM yyyy"),r&&e.jsx("span",{className:"bg-orange-100 text-orange-600 dark:bg-orange-500/20 dark:text-orange-400 px-1 py-px rounded text-[8px] uppercase tracking-wider font-bold",children:"Rev"}),o&&e.jsx("span",{className:"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400 px-1 py-px rounded text-[8px] uppercase tracking-wider font-bold",children:"Stl"})]})]}),e.jsxs("div",{className:"text-right shrink-0 ml-3 flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:`text-base font-black ${$?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400"}`,children:[$?"+":"âˆ’","â‚¹",Number(t.amount).toLocaleString()]}),e.jsxs("p",{className:`text-[10px] font-bold mt-0.5 ${x>=0?"text-emerald-500":"text-red-500"}`,children:["Bal: ",x>=0?"+":"âˆ’","â‚¹",Math.abs(x).toLocaleString()]})]}),!ye&&!a&&e.jsx(fa,{onEdit:()=>{K(t.type),pe(String(t.amount)),ue(c(new Date(t.date),"yyyy-MM-dd")),t.due_date&&J(c(new Date(t.due_date),"yyyy-MM-dd")),be(t.notes||""),Ge(t.id),E(!0)},onDelete:()=>X(t.id)})]})]}),n&&e.jsxs("div",{className:"mt-2.5",children:[e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-bold uppercase tracking-wider text-slate-400 mb-1",children:[e.jsxs("span",{children:["Settled â‚¹",k.toLocaleString()]}),e.jsx("span",{children:b<=0?"Fully Paid":`â‚¹${b.toLocaleString()} left`})]}),e.jsx("div",{className:"h-1 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${b<=0?"bg-emerald-500":"bg-indigo-500"}`,style:{width:`${Math.min(k/Number(t.amount)*100,100)}%`}})})]}),m&&e.jsxs("button",{onClick:()=>Jt(t.id),className:"flex items-center gap-1 text-[11px] text-slate-400 mt-2 hover:text-slate-600 dark:hover:text-slate-300 transition-colors",children:[e.jsx(Ca,{className:`w-3 h-3 transition-transform ${R?"rotate-180":""}`}),R?"Hide note":"Show note"]}),R&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1.5 pl-0.5 border-l-2 border-slate-200 dark:border-slate-700 ml-0.5 leading-relaxed",children:t.notes})]})]})}),t.receipt_url&&e.jsxs("div",{className:"mx-4 mb-3 cursor-pointer relative rounded-xl overflow-hidden border border-slate-100 dark:border-slate-800 group",onClick:()=>ee(t.receipt_url),children:[e.jsx("img",{src:t.receipt_url,alt:"Receipt",className:"w-full h-28 object-cover group-hover:brightness-90 transition-all"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity bg-black/20",children:e.jsx(ht,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"absolute top-1.5 left-1.5 bg-black/50 backdrop-blur-sm text-white text-[8px] font-black uppercase tracking-widest px-2 py-0.5 rounded-md flex items-center gap-1",children:[e.jsx(bt,{className:"w-2.5 h-2.5"})," Receipt"]})]})]},t.id)})})]}),e.jsx(de,{children:Xe&&e.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-4",onClick:()=>ee(null),children:[e.jsx("button",{className:"absolute top-5 right-5 p-2 bg-white/10 rounded-full text-white",onClick:()=>ee(null),children:e.jsx(ct,{className:"w-5 h-5"})}),e.jsx("img",{src:Xe,alt:"Receipt full view",className:"max-w-full max-h-full object-contain rounded-2xl shadow-2xl",onClick:t=>t.stopPropagation()})]})}),e.jsx(de,{children:Be&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center sm:items-center",children:[e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>q(),className:"absolute inset-0 bg-black/50 backdrop-blur-md"}),e.jsxs(S.form,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:28,stiffness:300},onSubmit:Vt,className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-t-[2.5rem] sm:rounded-[2.5rem] shadow-2xl border border-white/10 dark:border-slate-800 relative z-10 max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"px-7 pt-7 pb-0 shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white tracking-tight",children:"New Entry"}),e.jsx("p",{className:"text-[11px] text-slate-400 font-medium mt-0.5",children:i.name})]}),e.jsx("button",{type:"button",onClick:()=>q(),className:"w-10 h-10 flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-full text-slate-400 hover:text-slate-900 dark:hover:text-white active:scale-90 transition-all",children:e.jsx(Re,{className:"w-5 h-5 rotate-45"})})]}),e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsxs("button",{type:"button",onClick:()=>K("you_gave"),className:`flex-1 py-4 rounded-2xl font-black text-sm uppercase tracking-wider transition-all border-2 flex items-center justify-center gap-2.5 ${M==="you_gave"?"bg-rose-50 dark:bg-rose-500/10 border-rose-500 text-rose-600 dark:text-rose-400 shadow-lg shadow-rose-500/10":"bg-slate-50 dark:bg-slate-800/50 border-transparent text-slate-400 hover:border-slate-200 dark:hover:border-slate-700"}`,children:[e.jsx(pt,{className:"w-5 h-5"})," Given"]}),e.jsxs("button",{type:"button",onClick:()=>K("you_received"),className:`flex-1 py-4 rounded-2xl font-black text-sm uppercase tracking-wider transition-all border-2 flex items-center justify-center gap-2.5 ${M==="you_received"?"bg-emerald-50 dark:bg-emerald-500/10 border-emerald-500 text-emerald-600 dark:text-emerald-400 shadow-lg shadow-emerald-500/10":"bg-slate-50 dark:bg-slate-800/50 border-transparent text-slate-400 hover:border-slate-200 dark:hover:border-slate-700"}`,children:[e.jsx(ut,{className:"w-5 h-5"})," Received"]})]}),le&&d.length>0&&e.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-500/10 p-3 rounded-xl border border-indigo-100 dark:border-indigo-500/20 mb-5",children:e.jsxs("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 font-medium",children:[d.length," pending ",d.length===1?"entry":"entries"," for settlement."]})}),e.jsxs("div",{className:"text-center py-4 mb-2",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-[0.2em] mb-3",children:"Amount"}),e.jsxs("div",{className:"inline-flex items-baseline gap-1",children:[e.jsx("span",{className:"text-4xl font-black text-slate-300 dark:text-slate-600",children:"â‚¹"}),e.jsx("input",{type:"number",inputMode:"decimal",value:f,onChange:t=>pe(t.target.value),placeholder:"0",autoFocus:!0,className:"bg-transparent border-none text-[72px] leading-none font-black text-slate-900 dark:text-white placeholder:text-slate-200 dark:placeholder:text-slate-700 focus:ring-0 p-0 w-full max-w-[280px] text-center outline-none"})]}),le&&d.length>0&&Number(f)>ot&&e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-2 font-bold",children:["Max: â‚¹",ot.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-7 pb-4 space-y-4 scrollbar-hide",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-[0.15em] ml-1",children:"Date"}),e.jsxs("button",{type:"button",onClick:()=>he(!0),className:"w-full bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-2xl p-4 text-slate-900 dark:text-white font-bold text-left flex items-center gap-2.5 text-[13px] transition-all hover:border-indigo-400/50",children:[e.jsx(xa,{className:"w-4 h-4 text-indigo-400 shrink-0"}),c(new Date(v+"T00:00:00"),"MMM d, yyyy")]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-[0.15em] ml-1",children:"Due Date"}),e.jsxs("button",{type:"button",onClick:()=>V(!0),className:"w-full bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-2xl p-4 text-slate-900 dark:text-white font-bold text-left flex items-center gap-2.5 text-[13px] transition-all hover:border-indigo-400/50",children:[e.jsx(ma,{className:"w-4 h-4 text-indigo-400 shrink-0"}),y?c(new Date(y+"T00:00:00"),"MMM d, yyyy"):"No Date"]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-[0.15em] ml-1",children:"What is this for?"}),e.jsx("input",{type:"text",value:Z,onChange:t=>be(t.target.value),placeholder:"Enter description...",required:!0,className:"w-full bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-2xl p-4 text-slate-900 dark:text-white font-bold text-[13px] outline-none focus:border-indigo-400/50 transition-all placeholder:text-slate-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-[0.15em] ml-1",children:"Receipt / Bill"}),_?e.jsxs("div",{className:"relative rounded-2xl overflow-hidden border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50",children:[e.jsx("img",{src:_,alt:"Receipt",className:"w-full h-36 object-cover"}),e.jsxs("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center gap-3 opacity-0 hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:()=>ee(_),className:"p-2 bg-white/90 rounded-full text-slate-900 shadow",children:e.jsx(ht,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:()=>{ke(null),URL.revokeObjectURL(_),je(null)},className:"p-2 bg-white/90 rounded-full text-rose-500 shadow",children:e.jsx(ct,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"absolute top-2 right-2 bg-emerald-500 text-white text-[9px] font-black uppercase tracking-wider px-2 py-0.5 rounded-md",children:"Attached"})]}):e.jsxs("button",{type:"button",onClick:()=>Qe.current?.click(),className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl p-5 flex flex-col items-center justify-center gap-2 text-slate-400 hover:border-indigo-400/70 hover:text-indigo-500 hover:bg-indigo-50/40 dark:hover:bg-indigo-500/5 transition-all active:scale-[0.98]",children:[e.jsx(bt,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",children:"Attach Receipt or Bill"}),e.jsx("span",{className:"text-[10px] font-medium text-slate-300 dark:text-slate-600",children:"JPG, PNG â€” auto compressed"})]}),e.jsx("input",{ref:Qe,type:"file",accept:"image/*",className:"hidden",onChange:t=>{const a=t.target.files?.[0];if(!a)return;ke(a);const s=URL.createObjectURL(a);je(s)}})]})]}),e.jsx("div",{className:"px-7 py-5 border-t border-slate-100 dark:border-slate-800/50 shrink-0",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>q(),className:"flex-1 py-4 font-bold text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 rounded-2xl transition-colors text-sm",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!f||Number(f)<=0||Ze,className:"flex-[2] py-4 bg-indigo-600 disabled:bg-slate-200 dark:disabled:bg-slate-800 disabled:text-slate-400 disabled:shadow-none text-white font-black rounded-2xl shadow-lg shadow-indigo-500/20 active:scale-[0.98] transition-all text-sm uppercase tracking-wider flex items-center justify-center gap-2",children:Ze?e.jsxs(e.Fragment,{children:[e.jsx(pa,{className:"w-4 h-4 animate-spin"})," Uploading..."]}):le&&d.length>0?"Allocate â†’":"Save Entry"})]})}),e.jsx(ce,{isOpen:Lt,onClose:()=>he(!1),initialDate:new Date(v+"T00:00:00"),onSelect:t=>{const a=c(t,"yyyy-MM-dd");ue(a),Et||J(c(oe(t,10),"yyyy-MM-dd")),he(!1)}}),e.jsx(ce,{isOpen:It,onClose:()=>V(!1),initialDate:y?new Date(y+"T00:00:00"):oe(new Date,10),onSelect:t=>{J(c(t,"yyyy-MM-dd")),We(!0),V(!1)}})]})]})}),e.jsx(de,{children:et&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center p-4 pb-24 sm:p-6 sm:items-center",children:[e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>te(!1),className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),e.jsxs(S.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-[2rem] p-6 shadow-2xl border border-slate-100 dark:border-slate-800 relative z-10 max-h-[85vh] overflow-y-auto",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white border-b border-slate-100 dark:border-slate-800 pb-4 mb-6",children:["Allocate â‚¹",Number(U).toLocaleString()]}),e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl mb-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-sm",children:"Settle Oldest First"}),e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Auto-allocate from oldest"})]}),e.jsx("button",{type:"button",onClick:()=>{tt(!w),T({})},children:w?e.jsx(gt,{className:"w-10 h-10 text-indigo-600"}):e.jsx(ft,{className:"w-10 h-10 text-slate-400"})})]}),!w&&e.jsxs("div",{className:"space-y-3 mb-5",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Select entries"}),d.length===0?e.jsx("p",{className:"text-sm text-slate-500",children:"No pending entries."}):d.map(t=>{const a=B[t.id]!==void 0;return e.jsxs("div",{className:`p-4 rounded-2xl border transition-colors ${a?"border-indigo-500 bg-indigo-50/50 dark:bg-indigo-500/10":"border-slate-200 dark:border-slate-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("button",{type:"button",onClick:()=>ea(t.id,t.remaining),className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center ${a?"bg-indigo-600 border-indigo-600":"border-slate-300 dark:border-slate-600"}`,children:a&&e.jsx(Pe,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-sm",children:t.type==="you_gave"?"You Gave":"You Borrowed"}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:[c(new Date(t.date),"MMM d, yyyy")," â€¢ Rem â‚¹",t.remaining.toLocaleString()]})]})]}),e.jsxs("p",{className:"font-black text-slate-900 dark:text-white text-sm",children:["â‚¹",Number(t.amount).toLocaleString()]})]}),a&&e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 shrink-0",children:"Allocate:"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm font-bold text-slate-400",children:"â‚¹"}),e.jsx("input",{type:"number",value:B[t.id]||"",onChange:s=>{const r=Math.min(Number(s.target.value)||0,t.remaining);T(n=>({...n,[t.id]:String(r)}))},max:t.remaining,placeholder:"0",className:"w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl py-2 pl-8 pr-3 text-sm font-bold text-slate-900 dark:text-white outline-none"})]}),e.jsx("button",{type:"button",onClick:()=>T(s=>({...s,[t.id]:String(t.remaining)})),className:"text-[9px] font-bold uppercase text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-500/10 px-2 py-1 rounded-lg shrink-0",children:"Max"})]})]},t.id)}),re>0&&e.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-slate-500 pt-2 border-t border-slate-100 dark:border-slate-800",children:[e.jsx("span",{children:"Total allocated"}),e.jsxs("span",{className:re>Number(U)?"text-red-500":"text-emerald-500",children:["â‚¹",re.toLocaleString()," / â‚¹",Number(U).toLocaleString()]})]})]}),w&&d.length>0&&e.jsxs("div",{className:"space-y-2 mb-5",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-2",children:"Preview"}),(()=>{let t=Number(U);return d.map(a=>{if(t<=0)return null;const s=Math.min(a.remaining,t);return t-=s,e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white",children:a.type==="you_gave"?"You Gave":"You Borrowed"}),e.jsx("p",{className:"text-[10px] text-slate-400",children:c(new Date(a.date),"MMM d, yyyy")})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-black text-indigo-600 dark:text-indigo-400",children:["â‚¹",s.toLocaleString()]}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:["of â‚¹",a.remaining.toLocaleString()]})]})]},a.id)}).filter(Boolean)})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 block",children:"Note"}),e.jsx("input",{type:"text",value:W,onChange:t=>at(t.target.value),placeholder:"Payment note...",className:"w-full bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl p-3 text-slate-900 dark:text-white font-medium text-sm outline-none"})]}),e.jsxs("div",{className:"mt-5 flex items-center justify-between bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-200 dark:border-slate-700 cursor-pointer",onClick:()=>st(!Ne),children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-slate-900 dark:text-white text-sm flex items-center gap-1.5",children:[e.jsx(Ma,{className:"w-4 h-4 text-indigo-500"}),me?"Record as Income":"Record as Expense"]}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:"Add to main finance ledger"})]}),e.jsx("button",{type:"button",children:Ne?e.jsx(gt,{className:"w-8 h-8 text-indigo-600"}):e.jsx(ft,{className:"w-8 h-8 text-slate-400"})})]}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx("button",{type:"button",onClick:()=>{te(!1),T({})},className:"flex-1 py-3.5 font-bold text-slate-500 hover:bg-slate-50 dark:hover:bg-slate-800 rounded-xl",children:"Cancel"}),e.jsx("button",{type:"button",onClick:Qt,disabled:!w&&re<=0,className:"flex-[2] py-3.5 bg-indigo-600 disabled:bg-indigo-400 disabled:opacity-50 text-white font-black rounded-xl shadow-lg shadow-indigo-500/30 active:scale-[0.98] transition-transform",children:"Confirm Payment"})]})]})]})}),e.jsx(de,{children:ae&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center sm:items-center",children:[e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>G(!1),className:"absolute inset-0 bg-black/50 backdrop-blur-md"}),e.jsxs(S.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:28,stiffness:300},className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-t-[2.5rem] sm:rounded-[2.5rem] shadow-2xl border border-white/10 dark:border-slate-800 relative z-10 max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"px-7 pt-7 pb-4 mb-2 shrink-0 border-b border-slate-100 dark:border-slate-800/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white tracking-tight",children:"Send Reminder"}),e.jsx("p",{className:"text-[11px] text-slate-400 font-medium mt-0.5",children:i.name})]}),e.jsx("button",{type:"button",onClick:()=>G(!1),className:"w-10 h-10 flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-full text-slate-400 hover:text-slate-900 dark:hover:text-white active:scale-90 transition-all",children:e.jsx(Re,{className:"w-5 h-5 rotate-45"})})]})}),e.jsxs("div",{className:"flex-1 p-7 flex flex-col space-y-6 overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 p-1 bg-slate-100 dark:bg-slate-800/50 rounded-2xl w-full",children:[e.jsxs("button",{type:"button",onClick:()=>rt("whatsapp"),className:`py-4 rounded-xl flex flex-col items-center justify-center gap-2 transition-all ${h==="whatsapp"?"bg-white dark:bg-slate-700 shadow-md text-emerald-500":"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300"}`,children:[e.jsx(mt,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"WhatsApp"})]}),e.jsxs("button",{type:"button",onClick:()=>rt("sms"),className:`py-4 rounded-xl flex flex-col items-center justify-center gap-2 transition-all ${h==="sms"?"bg-white dark:bg-slate-700 shadow-md text-indigo-500":"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300"}`,children:[e.jsx(va,{className:"w-6 h-6"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"SMS"})]})]}),h==="whatsapp"&&e.jsxs("div",{className:"flex bg-slate-50 dark:bg-slate-800/20 p-1 rounded-xl w-full border border-slate-100 dark:border-slate-800 overflow-hidden",children:[e.jsx("button",{type:"button",onClick:()=>ve("text"),className:`flex-1 py-3 transition-all rounded-lg text-xs font-bold ${z==="text"?"bg-emerald-50 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400 shadow-sm":"text-slate-400"}`,children:"Text"}),e.jsxs("button",{type:"button",onClick:()=>ve("image"),className:`flex-1 flex items-center justify-center gap-1.5 py-3 transition-all rounded-lg text-xs font-bold ${z==="image"?"bg-emerald-50 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400 shadow-sm":"text-slate-400"}`,children:[e.jsx(Sa,{className:"w-3.5 h-3.5"})," Image"]}),e.jsxs("button",{type:"button",onClick:()=>ve("pdf"),className:`flex-1 flex items-center justify-center gap-1.5 py-3 transition-all rounded-lg text-xs font-bold ${z==="pdf"?"bg-emerald-50 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400 shadow-sm":"text-slate-400"}`,children:[e.jsx(_a,{className:"w-3.5 h-3.5"})," PDF"]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/20 rounded-[1.5rem] p-5 border border-slate-100 dark:border-slate-800/80",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400",children:"Select Entries to Send"}),e.jsx("button",{type:"button",onClick:()=>Ce(P.length===d.length?[]:d.map(t=>t.id)),className:"text-[10px] uppercase font-black tracking-widest text-indigo-500 hover:text-indigo-400 transition-colors",children:P.length===d.length?"Deselect All":"Select All"})]}),e.jsx("div",{className:"space-y-3 max-h-[160px] overflow-y-auto pr-2 scrollbar-none border-b border-t border-slate-100 dark:border-slate-800/50 py-2",children:d.map(t=>e.jsxs("div",{onClick:()=>{Ce(a=>a.includes(t.id)?a.filter(s=>s!==t.id):[...a,t.id])},className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("div",{className:`w-5 h-5 rounded-[6px] border flex items-center justify-center transition-colors ${P.includes(t.id)?"bg-indigo-500 border-indigo-500 text-white":"border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 group-hover:border-indigo-500"}`,children:P.includes(t.id)&&e.jsx(Pe,{className:"w-3.5 h-3.5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-slate-900 dark:text-white truncate",children:t.notes||"Entry"}),e.jsx("p",{className:"text-[10px] font-medium text-slate-400",children:c(new Date(t.date),"dd MMM yyyy")})]}),e.jsxs("p",{className:"text-xs font-black text-slate-900 dark:text-white shrink-0",children:["â‚¹",t.remaining.toLocaleString()]})]},t.id))})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/30 rounded-[1.5rem] p-5 border border-slate-100 dark:border-slate-800/80",children:[e.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-slate-400 mb-3",children:"Message Preview"}),e.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 p-4 rounded-xl text-xs font-medium text-slate-600 dark:text-slate-400 leading-relaxed whitespace-pre-wrap font-mono min-h-[120px] max-h-[140px] overflow-y-auto",children:Me})]}),d.length>4&&h==="whatsapp"&&z==="text"&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-500/10 p-3 rounded-lg border border-amber-200 dark:border-amber-500/30 text-center",children:e.jsx("p",{className:"text-[11px] font-bold text-amber-700 dark:text-amber-400",children:'Large breakdown. "Text + Image" is recommended.'})}),e.jsxs("button",{type:"button",onClick:()=>{h==="whatsapp"&&z==="image"?qt():it()},disabled:Se,className:`w-full py-5 rounded-2xl active:scale-[0.98] transition-all flex items-center justify-center gap-2.5 text-sm font-black uppercase tracking-wider ${h==="whatsapp"?"bg-emerald-500 hover:bg-emerald-400 text-white shadow-emerald-500/30":"bg-indigo-600 hover:bg-indigo-500 text-white shadow-indigo-600/30"}`,children:[Se?e.jsx(Ta,{className:"w-5 h-5 animate-spin"}):e.jsx(Da,{className:"w-5 h-5"}),Se?"Preparing...":`Send via ${h==="whatsapp"?"WhatsApp":"SMS"}`]})]})]})]})}),e.jsx(ce,{isOpen:At,onClose:()=>Fe(!1),initialDate:L?new Date(L+"T00:00:00"):new Date,onSelect:t=>{t&&Rt(c(t,"yyyy-MM-dd")),Fe(!1)}}),e.jsx(ce,{isOpen:Ot,onClose:()=>Ue(!1),initialDate:I?new Date(I+"T00:00:00"):new Date,onSelect:t=>{t&&$t(c(t,"yyyy-MM-dd")),Ue(!1)}}),e.jsx("div",{className:"absolute top-0 left-[-9999px]",children:e.jsxs("div",{ref:De,className:"w-[600px] bg-slate-900 text-white p-12 flex flex-col items-center justify-center text-center font-sans tracking-tight",children:[e.jsx("h1",{className:"text-[52px] font-black text-indigo-400 mb-6 uppercase tracking-widest leading-none",children:"AWAKE"}),e.jsx("p",{className:"text-xl font-bold text-slate-400 uppercase tracking-[0.2em] mb-12",children:"Account Overview"}),e.jsxs("div",{className:"bg-slate-800/80 rounded-[2.5rem] p-10 w-full border border-slate-700/50 shadow-2xl mb-8",children:[e.jsxs("div",{className:"mb-10 text-left w-full border-b border-slate-700/80 pb-6",children:[e.jsx("p",{className:"text-sm font-black text-slate-500 uppercase tracking-widest mb-2",children:"Prepared For"}),e.jsx("h2",{className:"text-3xl font-black text-white",children:i.name}),e.jsxs("p",{className:"text-slate-400 text-xl font-medium mt-1",children:[i.country_code||"+91"," ",i.phone_number]})]}),e.jsx("p",{className:"text-sm font-black text-slate-500 uppercase tracking-widest mb-3",children:"Total Outstanding Balance"}),e.jsxs("p",{className:`text-[80px] leading-none font-black mb-10 tracking-tighter ${u>0?"text-emerald-400":"text-rose-400"}`,children:["â‚¹",se.toLocaleString()]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-3xl p-6 border border-slate-700/50 text-left",children:[e.jsx("p",{className:"text-slate-400 font-black uppercase tracking-widest text-sm mb-4",children:"Pending Breakdown"}),e.jsx("div",{className:"space-y-3",children:Y.map(t=>e.jsxs("div",{className:"flex justify-between items-center text-slate-300 border-b border-slate-800 pb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:t.notes||"Entry"}),e.jsx("p",{className:"text-sm opacity-60",children:c(new Date(t.date),"dd MMM yyyy")})]}),e.jsxs("span",{className:"font-black",children:["â‚¹",t.remaining.toLocaleString()]})]},t.id))})]})]}),e.jsxs("div",{className:"flex items-center justify-between w-full px-6 opacity-60",children:[e.jsx("p",{className:"text-sm text-slate-400 font-bold uppercase tracking-widest",children:"Generated automatically"}),e.jsx("p",{className:"text-sm text-slate-400 font-bold tracking-widest",children:c(new Date,"dd MMM yyyy")})]})]})})]})};export{ds as default};
