import{j as e,l as ce,x as K,r,aj as z,A as Te,m as re,P as w,X as xe,J as X,$ as W,Z as Me,a9 as Ae,W as Le,a0 as Oe,E as q,z as me,ah as Pe,ak as he,D as L,al as pe,am as J,T as ue,v as Ee,an as Fe,ao as Ie,ap as le,aq as _,V as Re,U as N,ar as _e,as as ze}from"./index-9msspAXs.js";import{T as We}from"./TaskItem-DvR0dPsp.js";import{A as $e}from"./AddTaskModal-U-wb7eC7.js";import{C as ie}from"./chevron-down-TRwM3OYb.js";import{C as Be}from"./ConfirmDialog-CMCgwJdj.js";import{S as He,A as Ve}from"./sliders-horizontal-CJ8h67CS.js";import{D as Ue}from"./DateHeader-DlVVXuOB.js";import{D as qe}from"./DeleteConfirmationModal-C3Ect0Gz.js";import{u as Je,S as Ke}from"./useSelection-Lbc3MKXR.js";import{S as Xe}from"./square-check-big-dwW8C68g.js";import{P as Ze}from"./plus-CMsmunyR.js";import{E as Ge}from"./ellipsis-CVoln8BK.js";import"./sun-BQlunvnj.js";import"./book-open-CJ6BBX_i.js";import"./waves-DckeWPKZ.js";import"./flame-DbTI9LYX.js";import"./bike-Dlxb_FhM.js";import"./shopping-bag-CfRJAWU5.js";import"./mail-DbGZhtgd.js";import"./wallet-B-Jnzj-V.js";import"./circle-check-big-LAuxg_Ck.js";import"./ItemMenu-VUnNMYsH.js";import"./eye-BqTX6Mm8.js";import"./pen-DY3Fb26x.js";import"./triangle-alert-2A0dCFLU.js";import"./square-lZ11Ib2v.js";const ne=({tasks:d,onToggle:o,onDelete:s,onUpdate:x,isLocked:m,isVariant:h="default",onReschedule:u,onEdit:v,isSelectMode:f,selectedTaskIds:b,onSelect:p,onLongPress:c})=>d.length===0?null:e.jsx("div",{className:"space-y-3",children:d.map(l=>e.jsx(We,{task:l,onUpdateStatus:o,isLocked:m,variant:h,onReschedule:u,onDelete:s,onEdit:v,isSelectMode:f,isSelected:b?.has(l.id),onSelect:p,onLongPress:c},l.id))}),Qe=({isOpen:d,onClose:o,task:s})=>{ce(d);const{updateTask:x}=K(),[m,h]=r.useState(""),[u,v]=r.useState(""),[f,b]=r.useState("Work"),[p,c]=r.useState("Medium"),[l,C]=r.useState(""),[k,D]=r.useState(""),[i,S]=r.useState(!1);r.useEffect(()=>{d&&s&&(h(s.title||s.name||""),v(s.description||""),b(s.category||"Work"),c(s.priority||"Medium"),C(s.time||""),D(s.date||z(new Date,"yyyy-MM-dd")))},[d,s]);const[g,O]=r.useState(!1),A=(n=>n.trim()?n.trim().split(/\s+/).length:0)(u),$=n=>{const M=n.target.value;v(M)},P=async n=>{if(n.preventDefault(),!(!m.trim()||g||!s)){if(A>20){alert("Description must be 20 words or less.");return}O(!0);try{await x(s.id,{title:m,name:m,description:u,category:f,priority:p,time:l||null,date:k}),o()}catch(M){console.error("Error updating task:",M)}finally{O(!1)}}};return e.jsx(Te,{children:d&&e.jsxs(e.Fragment,{children:[e.jsx(re.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},onClick:o,className:"fixed inset-0 bg-black/40 dark:bg-black/60 z-[60]"}),e.jsx(re.div,{initial:{opacity:0,scale:.98,y:15},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.98,y:10},transition:{duration:.2,ease:"easeOut"},className:"fixed inset-0 z-[70] flex items-center justify-center p-4 sm:p-6 pointer-events-none",children:e.jsxs("div",{className:"bg-white dark:bg-[#111827] w-full max-w-sm rounded-[24px] pointer-events-auto flex flex-col shadow-2xl relative overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-100 dark:border-white/[0.06]",children:[e.jsx("h2",{className:"text-[17px] font-semibold text-slate-900 dark:text-white tracking-tight",children:"Edit Task"}),e.jsx(w,{onClick:o,scaleDown:.9,className:"p-1.5 -mr-1.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 rounded-full transition-colors ",children:e.jsx(xe,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[75vh]",children:e.jsxs("form",{id:"editTaskForm",onSubmit:P,className:"p-5 flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{children:e.jsx("input",{autoFocus:!0,type:"text",placeholder:"Task name",value:m,onChange:n=>h(n.target.value),className:"w-full text-[16px] bg-slate-50 dark:bg-white/[0.04] border border-transparent dark:border-white/[0.04] rounded-[14px] px-4 py-3.5 focus:ring-2 focus:ring-indigo-500/30 dark:focus:ring-indigo-500/40 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 font-medium transition-all"})}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{placeholder:"Description (optional)",value:u,onChange:$,rows:"2",className:"w-full text-[14px] bg-slate-50 dark:bg-white/[0.04] border border-transparent dark:border-white/[0.04] rounded-[14px] px-4 py-3 pb-8 focus:ring-2 focus:ring-indigo-500/30 dark:focus:ring-indigo-500/40 text-slate-700 dark:text-slate-300 placeholder-slate-400 dark:placeholder-slate-500 transition-all resize-none"}),e.jsxs("div",{className:"absolute bottom-2.5 right-3.5 text-[11px] font-medium text-slate-400 dark:text-slate-500 pointer-events-none",children:[A,"/20"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:f,onChange:n=>b(n.target.value),className:"w-full appearance-none bg-slate-50 dark:bg-white/[0.04] border border-transparent dark:border-white/[0.04] rounded-[12px] px-3.5 py-3 text-[14px] font-medium text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-indigo-500/30 transition-all",children:[e.jsx("option",{value:"Work",children:"Work"}),e.jsx("option",{value:"Health",children:"Health"}),e.jsx("option",{value:"Personal",children:"Personal"}),e.jsx("option",{value:"Spiritual",children:"Spiritual"}),e.jsx("option",{value:"Study",children:"Study"}),e.jsx("option",{value:"Finance",children:"Finance"})]}),e.jsx(ie,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:p,onChange:n=>c(n.target.value),className:"w-full appearance-none bg-slate-50 dark:bg-white/[0.04] border border-transparent dark:border-white/[0.04] rounded-[12px] px-3.5 py-3 text-[14px] font-medium text-slate-800 dark:text-slate-200 focus:ring-2 focus:ring-indigo-500/30 transition-all",children:[e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"})]}),e.jsx(ie,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"relative flex items-center bg-slate-50 dark:bg-white/[0.04] border border-transparent dark:border-white/[0.04] rounded-[12px] overflow-hidden focus-within:ring-2 focus-within:ring-indigo-500/30 transition-all",children:[e.jsx("div",{className:"pl-3.5 pr-2 py-3 flex items-center justify-center pointer-events-none",children:e.jsx(X,{className:"w-4 h-4 text-slate-400 dark:text-slate-500"})}),e.jsx("input",{type:"time",value:l,onChange:n=>C(n.target.value),className:"w-full bg-transparent border-none p-0 py-3 pr-3 text-[14px] font-medium text-slate-800 dark:text-slate-200 focus:ring-0"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>S(!i),className:"w-full h-full flex items-center bg-slate-50 dark:bg-white/[0.04] border border-transparent dark:border-white/[0.04] rounded-[12px] px-3.5 py-3 focus:ring-2 focus:ring-indigo-500/30 transition-all text-left",children:[e.jsx(W,{className:"w-4 h-4 text-slate-400 dark:text-slate-500 flex-shrink-0 mr-2"}),e.jsx("span",{className:"text-[14px] font-medium text-slate-800 dark:text-slate-200 truncate",children:k?z(new Date(k),"MMM do"):"Today"})]}),e.jsx(Me,{isOpen:i,initialDate:k?new Date(k):new Date,onSelect:n=>{n&&D(z(n,"yyyy-MM-dd"))},minDate:new Date,onClose:()=>S(!1)})]})]}),e.jsxs("div",{className:"pt-2 mt-1 flex items-center justify-end gap-2",children:[e.jsx(w,{type:"button",onClick:o,disabled:g,scaleDown:.96,className:"px-4 py-2.5 rounded-[12px] text-[15px] font-medium text-slate-500 hover:bg-slate-100 dark:hover:bg-white/[0.06] transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx(w,{type:"submit",disabled:!m.trim()||g,scaleDown:.96,className:"px-6 py-2.5 rounded-[12px] text-[15px] font-semibold text-white bg-indigo-600 dark:bg-indigo-500 hover:bg-indigo-700 dark:hover:bg-indigo-600 disabled:opacity-50 disabled:bg-slate-200 dark:disabled:bg-slate-800 dark:disabled:text-slate-500 transition-colors flex items-center",children:g?"Saving...":"Save Changes"})]})]})})]})})]})})};function oe(...d){return Oe(q(d))}const de={primary:"bg-primary-600 text-white hover:bg-primary-700 active:bg-primary-800",secondary:"bg-surface-elevated text-slate-900 dark:bg-surface-elevatedDark dark:text-white hover:bg-gray-200 dark:hover:bg-slate-700",ghost:"bg-transparent text-primary-600 hover:bg-primary-50 active:bg-primary-100 dark:text-primary-400 dark:hover:bg-primary-950",danger:"bg-red-500 text-white hover:bg-red-600 active:bg-red-700"},ge=Ae.forwardRef(({children:d,variant:o="primary",fullWidth:s=!1,isLoading:x=!1,disabled:m=!1,icon:h,className:u,onClick:v,...f},b)=>{const p=oe("relative flex items-center justify-center gap-2 min-h-[44px]","rounded font-medium transition-all outline-none","focus-visible:ring-2 focus-visible:ring-primary-500/50 focus-visible:ring-offset-2 dark:focus-visible:ring-offset-slate-900",de[o]||de.primary,s?"w-full":"",m||x?"opacity-50 cursor-not-allowed":"",u);return e.jsxs("button",{ref:b,onClick:v,disabled:m||x,className:p,...f,children:[e.jsxs("div",{className:oe("flex items-center justify-center gap-2",x&&"opacity-0"),children:[h&&e.jsx(h,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{children:d})]}),x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Le,{className:"w-5 h-5 animate-spin text-current"})})]})});ge.displayName="AppButton";const Ye=({isOpen:d,onClose:o})=>{ce(d);const{settings:s,updateSettings:x,clearAllTasks:m}=K(),[h,u]=r.useState("main"),[v,f]=r.useState(!1),[b,p]=r.useState(!1),c=me();if(!d)return null;const l=()=>{u("main"),o()},C=i=>{x({[i]:!s[i]})},k=(i,S)=>{x({[i]:S})},D=async()=>{f(!0);try{await m(),o()}catch(i){console.error("Failed to clear tasks",i),alert("Failed to clear tasks.")}finally{f(!1)}};return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center sm:p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm",onClick:l}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-t sm:rounded-3xl shadow-md relative z-10 overflow-hidden animate-in slide-in-from-bottom-full sm:slide-in-from-bottom-8 sm:zoom-in-95 duration-300 max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 pb-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-white/80 dark:bg-slate-900/80 backdrop-blur-md sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[h==="settings"?e.jsx(w,{onClick:()=>u("main"),scaleDown:.9,className:"p-1 -ml-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors mr-1 cursor-pointer",children:e.jsx(Pe,{className:"w-5 h-5 text-slate-500"})}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center",children:e.jsx(He,{className:"w-4 h-4 text-slate-600 dark:text-slate-300"})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:h==="settings"?"Task Settings":"More Options"})]}),e.jsx(w,{onClick:l,scaleDown:.9,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(xe,{className:"w-5 h-5 text-slate-500"})})]}),e.jsx("div",{className:"p-0 overflow-y-auto space-y-6 flex-1 py-4",children:h==="main"?e.jsxs("div",{className:"px-4 space-y-2",children:[e.jsxs(w,{onClick:()=>{c("/workspace/filter/all"),l()},scaleDown:.98,className:"w-full p-4 bg-slate-50 dark:bg-slate-800/50 rounded flex items-center justify-between border border-slate-100 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{className:"w-5 h-5 text-indigo-500"}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:"Active Tasks"})]}),e.jsx(L,{className:"w-5 h-5 text-slate-300"})]}),e.jsxs(w,{onClick:()=>{c("/workspace/calendar"),l()},scaleDown:.98,className:"w-full p-4 bg-slate-50 dark:bg-slate-800/50 rounded flex items-center justify-between border border-slate-100 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:"Calendar View"})]}),e.jsx(L,{className:"w-5 h-5 text-slate-300"})]}),e.jsxs(w,{onClick:()=>{c("/workspace/overview"),l()},scaleDown:.98,className:"w-full p-4 bg-slate-50 dark:bg-slate-800/50 rounded flex items-center justify-between border border-slate-100 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"w-5 h-5 text-purple-500"}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:"Weekly Overview"})]}),e.jsx(L,{className:"w-5 h-5 text-slate-300"})]}),e.jsxs(w,{onClick:()=>{c("/workspace/recent"),l()},scaleDown:.98,className:"w-full p-4 bg-slate-50 dark:bg-slate-800/50 rounded flex items-center justify-between border border-slate-100 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(X,{className:"w-5 h-5 text-emerald-500"}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:"Recent Tasks"})]}),e.jsx(L,{className:"w-5 h-5 text-slate-300"})]}),e.jsx("div",{className:"h-4"}),e.jsxs(w,{onClick:()=>u("settings"),scaleDown:.98,className:"w-full p-4 bg-slate-50 dark:bg-slate-800/50 rounded flex items-center justify-between border border-slate-100 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-slate-500"}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:"Task Settings"})]}),e.jsx(L,{className:"w-5 h-5 text-slate-300"})]})]}):e.jsxs("div",{className:"px-6 space-y-8",children:[e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(J,{className:"w-3 h-3"}),"Behavior Settings"]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded p-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-700 dark:text-slate-200 text-sm",children:"Auto-delete Completed"}),e.jsx("p",{className:"text-xs text-slate-400 font-medium mt-px",children:"Remove finished tasks after 24h"})]}),e.jsx("button",{onClick:()=>C("autoDeleteCompleted"),className:`w-12 h-6 rounded-full transition-colors relative shadow-md ${s.autoDeleteCompleted?"bg-indigo-500":"bg-slate-200 dark:bg-slate-700"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform shadow-sm ${s.autoDeleteCompleted?"translate-x-6":"translate-x-0"}`})})]}),e.jsx("hr",{className:"border-slate-200 dark:border-slate-800 mx-3"}),e.jsxs("div",{className:"flex items-center justify-between p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-700 dark:text-slate-200 text-sm",children:"Confirm Deletion"}),e.jsx("p",{className:"text-xs text-slate-400 font-medium mt-px",children:"Ask before deleting a task item"})]}),e.jsx("button",{onClick:()=>C("confirmDelete"),className:`w-12 h-6 rounded-full transition-colors relative shadow-md ${s.confirmDelete?"bg-indigo-500":"bg-slate-200 dark:bg-slate-700"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform shadow-sm ${s.confirmDelete?"translate-x-6":"translate-x-0"}`})})]}),e.jsx("hr",{className:"border-slate-200 dark:border-slate-800 mx-3"}),e.jsxs("div",{className:"flex items-center justify-between p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-700 dark:text-slate-200 text-sm",children:"Show Completed List"}),e.jsx("p",{className:"text-xs text-slate-400 font-medium mt-px",children:"Keep finished tasks visible"})]}),e.jsx("button",{onClick:()=>C("showCompletedInList"),className:`w-12 h-6 rounded-full transition-colors relative shadow-md ${s.showCompletedInList?"bg-indigo-500":"bg-slate-200 dark:bg-slate-700"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform shadow-sm ${s.showCompletedInList?"translate-x-6":"translate-x-0"}`})})]}),e.jsx("hr",{className:"border-slate-200 dark:border-slate-800 mx-3"}),e.jsxs(w,{onClick:()=>p(!0),disabled:v,scaleDown:.98,className:"w-full flex items-center justify-between p-3 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/10 rounded-lg transition-colors disabled:opacity-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{className:"font-bold text-sm",children:"Clear All Task Data"})]}),v?e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.jsx(L,{className:"w-4 h-4 opacity-40"})]})]})]}),e.jsxs("section",{className:"space-y-4 pb-4",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Default Values"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded border border-slate-100 dark:border-slate-800",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-2 uppercase tracking-wide",children:"Task Priority"}),e.jsxs("select",{value:s.defaultPriority,onChange:i=>k("defaultPriority",i.target.value),className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded p-2 text-sm font-bold text-slate-700 dark:text-slate-200 focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{children:"Low"}),e.jsx("option",{children:"Medium"}),e.jsx("option",{children:"High"})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded border border-slate-100 dark:border-slate-800",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-2 uppercase tracking-wide",children:"Duration (min)"}),e.jsx("input",{type:"number",value:s.defaultDuration,onChange:i=>k("defaultDuration",Number(i.target.value)),className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded p-2 text-sm font-bold text-slate-700 dark:text-slate-200 focus:ring-2 focus:ring-indigo-500"})]})]})]})]})}),e.jsx("div",{className:"p-4 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800 pb-[calc(env(safe-area-inset-bottom)+1rem)]",children:e.jsx(ge,{onClick:o,className:"w-full bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded py-4 font-bold active:scale-[0.98] transition-all",children:"Done"})})]}),e.jsx(Be,{isOpen:b,onClose:()=>p(!1),onConfirm:D,title:"Clear All Task Data?",message:"Are you sure you want to permanently delete ALL task history? This action cannot be undone and you will lose all previous records.",confirmText:"Delete All"})]})},Dt=()=>{const{t:d}=Ee(),{tasks:o,addTask:s,toggleTask:x,deleteTask:m,updateTask:h,isDayLocked:u,currentDateStr:v,rescheduleTask:f}=K(),b=Fe(),p=me(),[c,l]=r.useState(!1),[C,k]=r.useState(!1),D=r.useRef(null);r.useEffect(()=>{const t=a=>{D.current&&!D.current.contains(a.target)&&l(!1)};return c&&document.addEventListener("click",t,!0),()=>document.removeEventListener("click",t,!0)},[c]);const[i,S]=r.useState(()=>b.state?.initialDate?new Date(b.state.initialDate):new Date),g=z(i,"yyyy-MM-dd"),O=Ie(i,new Date),Z=le(_(i),_(new Date)),A=u(g),[$,P]=r.useState(!1),[n,M]=r.useState(null),[F,fe]=r.useState(()=>localStorage.getItem("awake_task_sort")||"default"),{isSelectionMode:G,selectedIds:I,toggleSelection:be,enterSelectionMode:ke,exitSelectionMode:B,toggleSelectAll:we,count:ve,isAllSelected:je}=Je(r.useMemo(()=>o.filter(t=>t.date===g).map(t=>t.id),[o,g])),[R,E]=r.useState([]),Q=t=>{ke(t)},Y=t=>{be(t)},ye=async()=>{try{const t=R.map(a=>m(a));await Promise.all(t),B(),E([])}catch(t){console.error("Failed to delete tasks:",t)}},Ne=t=>{fe(t),localStorage.setItem("awake_task_sort",t)},ee=r.useMemo(()=>{let a=[...o.filter(T=>T.date===g)];switch(F){case"category":a.sort((j,y)=>(j.category||"").localeCompare(y.category||""));break;case"priority":const T={High:1,Medium:2,Low:3};a.sort((j,y)=>(T[j.priority]||4)-(T[y.priority]||4));break;case"date":a.sort((j,y)=>{const se=new Date(j.date),ae=new Date(y.date);return(isNaN(se)?0:se.getTime())-(isNaN(ae)?0:ae.getTime())});break;case"time":a.sort((j,y)=>j.time?y.time?j.time.localeCompare(y.time):-1:1);break;default:a.sort((j,y)=>y.createdAt-j.createdAt);break}return a},[o,g,F]),H=o.filter(t=>{if(t.status==="completed"||t.isCompleted||!t.date)return!1;const a=new Date(t.date);return isNaN(a.getTime())?!1:le(_(a),_(i))}),[Ce,V]=r.useState(!1),De=async(t,a)=>{try{await s(t,{...a,date:a.date||g}),V(!1)}catch(T){console.error("Failed to add task from dashboard:",T),alert(`Failed to add task: ${T.message}`)}},te=t=>{t==="prev"&&S(a=>_e(a,1)),t==="next"&&S(a=>ze(a,1))},U=(t,a="today")=>{f(t,a==="today"?g:a)},Se=!A&&!Z;return e.jsx(Re,{bottomNav:!0,renderFloating:e.jsxs(e.Fragment,{children:[e.jsx($e,{isOpen:Ce,onClose:()=>V(!1),onAdd:De,initialDate:g}),e.jsx(Qe,{isOpen:$,onClose:()=>{P(!1),M(null)},task:n}),e.jsx(Ye,{isOpen:C,onClose:()=>k(!1)}),e.jsx(qe,{isOpen:R.length>0,onClose:()=>E([]),onConfirm:ye,title:R.length>1?`Delete ${R.length} tasks?`:"Delete task?",message:"Are you sure you want to delete this? This action cannot be undone."})]}),header:e.jsxs("div",{className:"contents",children:[e.jsx(Ke,{count:ve,isAllSelected:je,onCancel:B,onSelectAll:we,actions:[{label:"Mark Complete",icon:e.jsx(Xe,{className:"w-5 h-5"}),onClick:()=>{I.forEach(t=>x(t)),B()}},{label:"Delete",icon:e.jsx(ue,{className:"w-5 h-5"}),onClick:()=>E(I),variant:"danger"}]}),e.jsx(Ue,{allowFuture:!0,isLocked:A,dateStateOverride:{currentDate:i,isToday:O,prevDay:()=>te("prev"),nextDay:()=>te("next"),jumpToToday:t=>S(t instanceof Date?t:new Date)},rightNode:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0 pl-1",children:[Se&&e.jsxs(N,{variant:"ghost",onClick:()=>V(!0),className:"flex flex-col items-center justify-center p-1 sm:p-2 text-indigo-600 dark:text-sky-400 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl group",children:[e.jsx(Ze,{className:"w-7 h-7 sm:w-8 sm:h-8 stroke-[2.5]"}),e.jsx("span",{className:"text-[10px] sm:text-[11px] font-bold uppercase tracking-wider mt-0.5 group-hover:text-indigo-700",children:"Add Task"})]}),e.jsxs("div",{className:"relative shrink-0",ref:D,children:[e.jsx(N,{variant:"ghost",onClick:t=>{t.stopPropagation(),l(!c)},className:q("flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-xl bg-slate-50 dark:bg-slate-900 border border-slate-100 dark:border-slate-800 text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-white dark:hover:bg-slate-800",c&&"bg-slate-200 dark:bg-slate-800 text-slate-800 dark:text-white"),children:e.jsx(Ge,{className:"w-5 h-5 sm:w-6 sm:h-6 stroke-[2]"})}),e.jsxs("div",{className:q("absolute top-[calc(100%+8px)] right-0 bg-white dark:bg-[#16202f] border border-slate-200 dark:border-white/[0.09] rounded-[20px] p-2.5 flex flex-col gap-1 min-w-[260px] shadow-2xl dark:shadow-[0_24px_54px_rgba(0,0,0,0.65),0_0_0_1px_rgba(255,255,255,0.03)] z-[200] origin-top-right transition-all duration-200",c?"opacity-100 scale-100 translate-y-0 pointer-events-auto":"opacity-0 scale-[0.96] -translate-y-1.5 pointer-events-none"),children:[e.jsx("div",{className:"font-mono text-[11px] text-slate-400 dark:text-white/20 tracking-[0.1em] uppercase px-3.5 pt-2 pb-1.5 flex items-center h-4",children:"Actions"}),e.jsxs(N,{variant:"ghost",onClick:()=>{const t=["default","category","priority","time"],a=t[(t.indexOf(F)+1)%t.length];Ne(a)},className:"flex items-center gap-3 px-3.5 py-3 rounded-[12px] hover:bg-slate-50 dark:hover:bg-white/[0.06] text-slate-600 dark:text-white/60 hover:text-indigo-600 dark:hover:text-white text-left w-full text-[15px] font-semibold",children:[e.jsx("div",{className:"w-[28px] h-[28px] rounded-[8px] flex items-center justify-center shrink-0 bg-indigo-500/10 dark:bg-indigo-400/10",children:e.jsx(Ve,{className:"w-4 h-4 text-indigo-500 dark:text-indigo-400"})}),e.jsxs("div",{className:"flex-1 flex justify-between items-center pr-1",children:[e.jsx("span",{children:"Sort"}),e.jsx("span",{className:"text-[10px] font-bold text-indigo-500 uppercase tracking-wider",children:F})]})]}),e.jsx("div",{className:"h-px bg-slate-100 dark:bg-white/[0.06] mx-2 my-1"}),e.jsx("div",{className:"font-mono text-[11px] text-slate-400 dark:text-white/20 tracking-[0.1em] uppercase px-3.5 pt-2 pb-1.5 flex items-center h-4",children:"View"}),e.jsxs(N,{variant:"ghost",onClick:()=>{p("/workspace/filter/all"),l(!1)},className:"flex items-center gap-3 px-3.5 py-3 rounded-[12px] hover:bg-slate-50 dark:hover:bg-white/[0.06] text-slate-600 dark:text-white/60 hover:text-indigo-600 dark:hover:text-white text-left w-full text-[15px] font-semibold",children:[e.jsx("div",{className:"w-[28px] h-[28px] rounded-[8px] flex items-center justify-center shrink-0 bg-sky-500/10 dark:bg-sky-400/10",children:e.jsx(he,{className:"w-4 h-4 text-sky-500 dark:text-sky-400"})}),e.jsx("span",{children:"Active Tasks"})]}),e.jsxs(N,{variant:"ghost",onClick:()=>{p("/workspace/calendar"),l(!1)},className:"flex items-center gap-3 px-3.5 py-3 rounded-[12px] hover:bg-slate-50 dark:hover:bg-white/[0.06] text-slate-600 dark:text-white/60 hover:text-indigo-600 dark:hover:text-white text-left w-full text-[15px] font-semibold",children:[e.jsx("div",{className:"w-[28px] h-[28px] rounded-[8px] flex items-center justify-center shrink-0 bg-blue-500/10 dark:bg-blue-400/10",children:e.jsx(W,{className:"w-4 h-4 text-blue-500 dark:text-blue-400"})}),e.jsx("span",{children:"Calendar View"})]}),e.jsxs(N,{variant:"ghost",onClick:()=>{p("/workspace/overview"),l(!1)},className:"flex items-center gap-3 px-3.5 py-3 rounded-[12px] hover:bg-slate-50 dark:hover:bg-white/[0.06] text-slate-600 dark:text-white/60 hover:text-indigo-600 dark:hover:text-white text-left w-full text-[15px] font-semibold",children:[e.jsx("div",{className:"w-[28px] h-[28px] rounded-[8px] flex items-center justify-center shrink-0 bg-purple-500/10 dark:bg-purple-400/10",children:e.jsx(pe,{className:"w-4 h-4 text-purple-500 dark:text-purple-400"})}),e.jsx("span",{children:"Weekly Overview"})]}),e.jsxs(N,{variant:"ghost",onClick:()=>{p("/workspace/filter/recent"),l(!1)},className:"flex items-center gap-3 px-3.5 py-3 rounded-[12px] hover:bg-slate-50 dark:hover:bg-white/[0.06] text-slate-600 dark:text-white/60 hover:text-indigo-600 dark:hover:text-white text-left w-full text-[15px] font-semibold",children:[e.jsx("div",{className:"w-[28px] h-[28px] rounded-[8px] flex items-center justify-center shrink-0 bg-emerald-500/10 dark:bg-emerald-400/10",children:e.jsx(X,{className:"w-4 h-4 text-emerald-500 dark:text-emerald-400"})}),e.jsx("span",{children:"Recent Tasks"})]}),e.jsx("div",{className:"h-px bg-slate-100 dark:bg-white/[0.06] mx-2 my-1"}),e.jsx("div",{className:"font-mono text-[11px] text-slate-400 dark:text-white/20 tracking-[0.1em] uppercase px-3.5 pt-2 pb-1.5 flex items-center h-4",children:"Options"}),e.jsxs(N,{variant:"ghost",onClick:()=>{k(!0),l(!1)},className:"flex items-center gap-3 px-3.5 py-3 rounded-[12px] hover:bg-slate-50 dark:hover:bg-white/[0.06] text-slate-600 dark:text-white/60 hover:text-indigo-600 dark:hover:text-white text-left w-full text-[15px] font-semibold",children:[e.jsx("div",{className:"w-[28px] h-[28px] rounded-[8px] flex items-center justify-center shrink-0 bg-slate-500/10 dark:bg-slate-400/10",children:e.jsx(J,{className:"w-4 h-4 text-slate-500 dark:text-slate-400"})}),e.jsx("span",{children:"Task Settings"})]})]})]})]})})]}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("section",{children:ee.length>0?e.jsx(ne,{tasks:ee,onToggle:x,onDelete:t=>E([t]),onUpdate:h,onEdit:t=>{M(t),P(!0)},isLocked:A,onReschedule:U,isSelectMode:G,selectedTaskIds:new Set(I),onSelect:Y,onLongPress:Q}):e.jsxs("div",{className:"text-center py-12 border border-dashed border-slate-200 dark:border-slate-800 rounded-2xl",children:[e.jsx(W,{className:"w-8 h-8 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e.jsxs("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:["No tasks scheduled for ",O?"today":"this day","."]}),e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-1",children:"Add tasks only if they support your routine."})]})}),H.length>0&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Carried Over Tasks"}),e.jsx("div",{className:"h-px flex-1 bg-slate-100 dark:bg-slate-800"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{tasks:H,onToggle:x,onDelete:t=>E([t]),onUpdate:h,onEdit:t=>{M(t),P(!0)},isLocked:!1,onReschedule:U,isVariant:"carry_over",isSelectMode:G,selectedTaskIds:new Set(I),onSelect:Y,onLongPress:Q}),e.jsx(N,{variant:"ghost",onClick:()=>{H.forEach(t=>U(t.id,"today"))},label:"Move all to Today",className:"w-full mt-3 py-2.5 rounded-xl border border-slate-200 dark:border-slate-800 text-[13px] font-medium text-slate-500 hover:text-indigo-600 hover:bg-slate-50 dark:hover:bg-slate-800/50"})]})]})]})})};export{Dt as default};
