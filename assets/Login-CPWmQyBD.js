import{r as i,s as H,a as p,b as I,t as T,c as $,u as X,d as Z,e as P,f as _,j as e,F as J,N as K,m as w,g as Q,A as Y,h as ee,L as se,B as E,i as te,G as ae,k as re}from"./index-9msspAXs.js";import{I as b}from"./Input-CtVFuM9b.js";import{A as ie}from"./AppCard-BD1UyFUM.js";import{E as ne}from"./ErrorDisplay-Bku8UscT.js";import{C as A}from"./circle-check-big-LAuxg_Ck.js";import{C as oe}from"./circle-x-yBSa2Ww0.js";import"./wifi-off-CuncZRhC.js";const le=()=>{const[a,g]=i.useState(!1),[l,n]=i.useState(null),[m,d]=i.useState(!1),h=async(u,o)=>{n(null),d(!0);try{const r=await H(p,u,o);if(!r.user.emailVerified)throw await I(p),new Error("Please verify your email address to log in.");return a||(d(!1),n(null)),T("email"),r.user}catch(r){a||(console.error(r),n(r.message),d(!1))}};return i.useEffect(()=>()=>g(!0),[]),{login:h,error:l,isPending:m}},de=()=>{const[a,g]=i.useState(null),[l,n]=i.useState(!1);return{signup:async(d,h,u)=>{g(null),n(!0);try{const o=await $(p,d,h);if(!o)throw new Error("Could not complete signup");const r=`https://ui-avatars.com/api/?name=${encodeURIComponent(u)}&background=random&color=fff&bold=true`;return await X(o.user,{displayName:u,photoURL:r}),d.endsWith("@example.com")?(n(!1),P("email"),{verificationRequired:!1}):(await Z(o.user),await I(p),n(!1),P("email"),{verificationRequired:!0})}catch(o){throw console.error("Signup Failed:",o),g(o.message),n(!1),o}},error:a,isPending:l}},fe=()=>{const[a,g]=i.useState(!1),[l,n]=i.useState(""),[m,d]=i.useState(""),[h,u]=i.useState(""),[o,r]=i.useState(null),[v,j]=i.useState(!1),[x,f]=i.useState(null),{login:L,error:R,isPending:F}=le(),{signup:z,error:G,isPending:M}=de(),{user:q,authIsReady:B}=_(),[y,N]=i.useState(null),D=["tempmail.com","10minutemail.com","mailinator.com","yopmail.com","guerrillamail.com","sharklasers.com","throwawaymail.com","getnada.com","dispostable.com","fake-email.com"],k=s=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return!1;const c=s.split("@")[1];return c?!D.includes(c.toLowerCase()):!1},O=s=>new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9!@#$%^&*])(?=.{8,})").test(s),W=async s=>{if(s.preventDefault(),r(null),N(null),a){if(!k(l)){r("Please use a valid, permanent email address.");return}if(!O(m)){r("Password must be at least 8 characters with 1 uppercase letter and 1 number/symbol.");return}const t=await z(l,m,h);t&&t.verificationRequired&&(N("Account created! We sent you a verification email. Please verify to log in."),g(!1),n(""),d(""),u(""))}else await L(l,m)},U=async()=>{r(null),j(!0);const s=new ae;try{await re(p,s)}catch(t){console.error("Error signing in with Google:",t);let c="Failed to sign in with Google.";t.code==="auth/popup-closed-by-user"?c="Sign-in popup was closed.":t.code==="auth/cancelled-popup-request"?c="Only one popup request is allowed at a time.":t.code==="auth/popup-blocked"?c="Sign-in popup was blocked by the browser.":t.code==="auth/operation-not-allowed"?c="Google Sign-In is not enabled in Firebase Console.":t.code==="auth/unauthorized-domain"?c="This domain is not authorized in Firebase Console.":c=t.message||"An unknown error occurred.",r(c),j(!1)}},V=()=>{g(!a),n(""),d(""),u(""),r(null)};if(!B)return e.jsx(J,{});if(q)return e.jsx(K,{to:"/",replace:!0});const C=a?M:F,S=a?G:R;return e.jsxs("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4 dark:bg-slate-950 transition-colors relative overflow-hidden",children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-indigo-500/10 rounded-full blur-[100px]"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-purple-500/10 rounded-full blur-[100px]"})]}),e.jsx(w.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},className:"w-full max-w-md relative z-10",children:e.jsxs(ie,{className:"shadow-2xl border-0 bg-white/80 backdrop-blur-2xl dark:bg-slate-900/80 dark:border-slate-800 rounded-3xl overflow-hidden",children:[e.jsxs(CardHeader,{className:"space-y-2 text-center pb-6 pt-8",children:[e.jsx("div",{className:"mx-auto flex justify-center mb-6 relative",children:e.jsx("div",{className:"relative",children:e.jsx("img",{src:Q,alt:"Awake Logo",className:"h-8 w-auto relative z-10 drop-shadow-sm object-contain dark:brightness-0 dark:invert"})})}),e.jsx(CardTitle,{className:"text-3xl font-bold tracking-tight text-slate-900 dark:text-white",children:a?"Create Account":"Welcome Back"}),e.jsx("p",{className:"text-slate-500 font-medium dark:text-slate-400",children:a?"Create your universal identity":"Sign in to access your space"})]}),e.jsx(CardContent,{className:"px-8 pb-10",children:e.jsxs("form",{onSubmit:W,className:"space-y-5",children:[e.jsx(Y,{mode:"popLayout",children:a&&e.jsx(w.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 overflow-hidden",children:e.jsx(b,{type:"text",placeholder:"Display Name",value:h,onChange:s=>u(s.target.value),required:!0,className:"h-12 bg-slate-50 border-transparent focus:bg-white transition-all text-lg"})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(b,{type:"email",placeholder:"Email address",value:l,onChange:s=>{const t=s.target.value;n(t),t.length>0?t.includes("@")&&t.includes(".")?f(k(t)):f(!1):f(null)},autoComplete:"email",required:!0,className:ee("h-12 bg-slate-50 border-transparent focus:bg-white transition-all text-lg pr-12",x===!0&&"border-green-500 focus:ring-green-500",x===!1&&l.length>0&&"border-red-500 focus:ring-red-500")}),e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:[x===!0&&e.jsx(A,{className:"w-5 h-5 text-green-500"}),x===!1&&l.length>0&&e.jsx(oe,{className:"w-5 h-5 text-red-500"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(b,{type:"password",placeholder:"Password",value:m,onChange:s=>d(s.target.value),autoComplete:a?"new-password":"current-password",required:!0,className:"h-12 bg-slate-50 border-transparent focus:bg-white transition-all text-lg"}),!a&&e.jsx("div",{className:"flex justify-end",children:e.jsx(se,{to:"/forgot-password",className:"text-xs font-medium text-indigo-600 hover:text-indigo-700 hover:underline dark:text-indigo-400",children:"Forgot password?"})})]})]}),(S||o)&&e.jsx(ne,{type:"auth",title:"Authentication Error",message:(()=>{const s=o||S||"";return s.includes("auth/invalid-credential")||s.includes("auth/wrong-password")||s.includes("auth/user-not-found")?"Incorrect email or password.":s.includes("auth/too-many-requests")?"Too many failed attempts. Please try again later.":s.includes("auth/email-already-in-use")?"Email already in use. Please sign in.":s.includes("auth/weak-password")?"Password is too weak. Try a stronger one.":s.replace("Firebase:","").replace("Error:","").trim()})()}),y&&e.jsxs(w.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"text-sm font-medium text-green-600 bg-green-50 p-3 rounded-xl border border-green-100 flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),y]}),e.jsxs(E,{type:"submit",className:"w-full h-12 text-lg font-bold bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg shadow-indigo-200 dark:shadow-none rounded-xl",isLoading:C,children:[a?"Create Account":"Sign In (Updated)",!C&&e.jsx(te,{className:"ml-2 w-5 h-5"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-slate-200 dark:border-slate-700"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-white px-2 text-slate-500 dark:bg-slate-900 dark:text-slate-400",children:"Or continue with"})})]}),e.jsxs(E,{type:"button",onClick:U,className:"w-full h-12 text-base font-semibold bg-white hover:bg-slate-50 text-slate-700 border border-slate-200 shadow-sm hover:shadow-md transition-all rounded-xl flex items-center justify-center gap-3 dark:bg-slate-800 dark:border-slate-700 dark:text-white dark:hover:bg-slate-700",isLoading:v,children:[!v&&e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]}),e.jsx("div",{className:"text-center pt-2",children:e.jsx("button",{type:"button",onClick:V,className:"inline-flex items-center justify-center gap-2 text-sm font-semibold text-slate-600 hover:text-indigo-600 transition-colors py-2 px-4 rounded-lg hover:bg-indigo-50 dark:text-slate-400 dark:hover:text-indigo-400 dark:hover:bg-slate-800",children:a?e.jsxs(e.Fragment,{children:["Already have account? ",e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400",children:"Sign In"})]}):e.jsxs(e.Fragment,{children:["New here? ",e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400",children:"Create Account"})]})})})]})})]})}),e.jsx("div",{className:"absolute bottom-4 left-0 w-full text-center z-10",children:e.jsx("p",{className:"text-[10px] font-black text-slate-300 dark:text-slate-700 uppercase tracking-[0.2em] opacity-60",children:"Developed by CoolCraft"})})]})};export{fe as default};
