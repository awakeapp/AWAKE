import{z as D,f as T,n as R,j as e,V as P,a3 as U,a4 as u,a5 as o,H as E,am as N,O as y,T as L,q as M,r as b,X as j,W as I,A as F,m as O}from"./index-9msspAXs.js";import{S as k}from"./storageService-D4sI_jcd.js";import{F as _}from"./file-text-D1hEm-Wh.js";import{S as B}from"./shield-alert-DOWk1i5L.js";import{D as Z}from"./download-DCwt85j4.js";import{A as z}from"./archive-DkholNfQ.js";import{Z as W}from"./zoom-in-B__wRO_I.js";import{U as v}from"./upload-BCdVV1xp.js";const q=[{id:"rc_book",label:"RC Book",subtitle:"Registration Certificate",icon:_,color:"indigo"},{id:"insurance",label:"Insurance",subtitle:"Policy certificate",icon:B,color:"emerald"},{id:"pollution",label:"PUC Certificate",subtitle:"Pollution Under Control",icon:y,color:"amber"},{id:"service_book",label:"Service Book",subtitle:"Manufacturer service record",icon:N,color:"blue"}],w={indigo:"bg-indigo-50 dark:bg-indigo-500/10 text-indigo-600 dark:text-indigo-400",emerald:"bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400",amber:"bg-amber-50 dark:bg-amber-500/10 text-amber-700 dark:text-amber-400",blue:"bg-blue-50 dark:bg-blue-500/10 text-blue-600 dark:text-blue-400"},H=({doc:t,vehicleId:n,currentUrl:l,userId:d,onUpdate:x})=>{const{showToast:i}=M(),r=b.useRef(null),[s,m]=b.useState(!1),[h,a]=b.useState(!1),C=t.icon,S=w[t.color]||w.indigo,g=!!l,V=async c=>{const f=c.target.files?.[0];if(f){m(!0);try{const p=`users/${d}/vehicles/${n}/docs/${t.id}.jpg`,{url:A}=await k.uploadImage(f,p);await x({[`docs.${t.id}`]:A}),i(`${t.label} uploaded!`,"success")}catch(p){i(`Upload failed: ${p.message}`,"error")}finally{m(!1),c.target.value=""}}},$=async()=>{try{await k.deleteImage(`users/${d}/vehicles/${n}/docs/${t.id}.jpg`),await x({[`docs.${t.id}`]:null}),i(`${t.label} removed.`,"info")}catch{i("Remove failed.","error")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shrink-0 ${S}`,children:e.jsx(C,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-black text-slate-900 dark:text-white text-sm",children:t.label}),e.jsx("p",{className:"text-[11px] text-slate-400",children:t.subtitle})]}),g?e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded-full flex items-center gap-1",children:[e.jsx(y,{className:"w-2.5 h-2.5"})," Saved"]})}):e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-400",children:"None"})]}),g?e.jsxs("div",{className:"px-4 pb-4 space-y-2",children:[e.jsxs("div",{className:"relative rounded-xl overflow-hidden border border-slate-100 dark:border-slate-800 cursor-pointer group",onClick:()=>a(!0),children:[e.jsx("img",{src:l,alt:t.label,className:"w-full h-32 object-cover group-hover:brightness-90 transition-all"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity bg-black/20",children:e.jsx(W,{className:"w-6 h-6 text-white"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>r.current?.click(),className:"flex-1 py-2.5 border border-slate-200 dark:border-slate-700 rounded-xl text-[11px] font-black uppercase tracking-wider text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors flex items-center justify-center gap-1.5 active:scale-95",children:[e.jsx(v,{className:"w-3.5 h-3.5"})," Replace"]}),e.jsxs("button",{onClick:$,className:"flex-1 py-2.5 border border-red-100 dark:border-red-500/20 rounded-xl text-[11px] font-black uppercase tracking-wider text-rose-500 hover:bg-red-50 dark:hover:bg-red-500/10 transition-colors flex items-center justify-center gap-1.5 active:scale-95",children:[e.jsx(j,{className:"w-3.5 h-3.5"})," Remove"]})]})]}):e.jsx("div",{className:"px-4 pb-4",children:e.jsx("button",{onClick:()=>r.current?.click(),disabled:s,className:"w-full py-3 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl flex items-center justify-center gap-2 text-slate-400 hover:border-indigo-400/60 hover:text-indigo-500 hover:bg-indigo-50/40 dark:hover:bg-indigo-500/5 transition-all text-[11px] font-black uppercase tracking-widest active:scale-[0.98] disabled:opacity-50",children:s?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 animate-spin"})," Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-4 h-4"})," Upload Photo"]})})}),e.jsx("input",{ref:r,type:"file",accept:"image/*",className:"hidden",onChange:V})]}),e.jsx(F,{children:h&&e.jsxs(O.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-4",onClick:()=>a(!1),children:[e.jsx("button",{className:"absolute top-5 right-5 p-2 bg-white/10 rounded-full text-white",onClick:()=>a(!1),children:e.jsx(j,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center",onClick:c=>c.stopPropagation(),children:[e.jsx("p",{className:"text-white/60 text-[10px] font-black uppercase tracking-widest mb-3",children:t.label}),e.jsx("img",{src:l,alt:t.label,className:"max-w-full max-h-[80vh] object-contain rounded-2xl shadow-2xl"})]})]})})]})},se=()=>{const t=D(),{user:n}=T(),{vehicles:l,getActiveVehicle:d,toggleArchiveVehicle:x,deleteVehicle:i,updateVehicle:r}=R(),s=d(),m=()=>{s&&alert("Exporting "+s.name+" data as CSV...")},h=async a=>{s&&await r(s.id,a)};return e.jsx(P,{title:"Vehicle Settings",showBack:!0,children:e.jsxs(U,{children:[e.jsxs(u,{title:"Management",children:[e.jsx(o,{icon:E,title:"Manage Vehicles",subtitle:`${l.length} Total Vehicles`,onClick:()=>t("/vehicle/dashboard?manage=true")}),e.jsx(o,{icon:N,title:"Maintenance Templates",subtitle:"Service intervals & checklists",onClick:()=>alert("Templates module coming soon"),isLast:!0})]}),s&&e.jsx(u,{title:`${s.name} — Documents`,children:e.jsxs("div",{className:"px-4 py-3 space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Store your vehicle documents securely. Photos are auto-compressed and stored privately."}),q.map(a=>e.jsx(H,{doc:a,vehicleId:s.id,currentUrl:s?.docs?.[a.id]||null,userId:n?.uid,onUpdate:h},a.id))]})}),s&&e.jsxs(u,{title:`${s.name} — Danger Zone`,children:[e.jsx(o,{icon:Z,title:"Export Vehicle Data",subtitle:"Download ledger as CSV",onClick:m}),e.jsx(o,{icon:z,title:"Archive This Vehicle",isDanger:!0,onClick:()=>{window.confirm("Archive "+s.name+"?")&&(x(s.id),t(-1))}}),e.jsx(o,{icon:L,title:"Delete Vehicle",isDanger:!0,isLast:!0,onClick:()=>{window.confirm("Are you sure? This is permanent.")&&(i(s.id),t("/vehicle"))}})]}),e.jsx("p",{className:"text-center text-[11px] text-slate-400 dark:text-slate-600 mt-8 font-bold tracking-widest uppercase",children:"AWAKE Vehicle Module"})]})})};export{se as default};
