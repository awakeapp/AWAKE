import{l as ee,o as te,f as ie,r as i,aj as F,q as se,ab as ne,j as e,A as q,m as k,i as re,U as P,$ as de,Z as xe,Y as Q,X as oe,O as me,z as ce,a1 as pe,a2 as ue,v as he,av as ge,aw as be,aH as fe,V as je,P as Z,az as Ne}from"./index-9msspAXs.js";import{T as we,L as ve}from"./lucide-react-DcwRLu5a.js";import{C as ke}from"./ConfirmDialog-CMCgwJdj.js";import{W as ye}from"./wallet-B-Jnzj-V.js";import{A as Ce}from"./arrow-right-left-BZqzp5zj.js";import{S as Se}from"./settings-2-BceFCv8d.js";import{T as K}from"./trending-up-kT6XmkFT.js";import{T as Ae}from"./trending-down-CdZPREFM.js";import{u as Me}from"./useThemeColor-07YgPz61.js";import{F as De}from"./FinanceBottomNav-DgxfkZ8a.js";import{P as Te}from"./plus-CMsmunyR.js";import{s as Le}from"./subMonths-1p3dUHNQ.js";import"./archive-DkholNfQ.js";import"./send-CoIWtUcL.js";import"./sliders-horizontal-CJ8h67CS.js";import"./waves-DckeWPKZ.js";import"./award-BlapaDF1.js";import"./wrench-Cb94Jej8.js";import"./bell-Dygtp_OY.js";import"./bike-Dlxb_FhM.js";import"./book-open-CJ6BBX_i.js";import"./shopping-bag-CfRJAWU5.js";import"./shield-HLcdxMSU.js";import"./salad-CkDdq_AP.js";import"./chart-column-B0mH7TuE.js";import"./chevron-down-TRwM3OYb.js";import"./droplets-DFO5GKWj.js";import"./circle-check-big-LAuxg_Ck.js";import"./circle-question-mark-DV2LfSbz.js";import"./circle-x-yBSa2Ww0.js";import"./minus-PclDH3AR.js";import"./navigation-DwdKz1qA.js";import"./credit-card-iuEUgePA.js";import"./handshake-C4G9Q7ql.js";import"./download-DCwt85j4.js";import"./eye-BqTX6Mm8.js";import"./ellipsis-CVoln8BK.js";import"./file-text-D1hEm-Wh.js";import"./flame-DbTI9LYX.js";import"./fuel-CJFsjG9T.js";import"./globe-D78FqA_e.js";import"./hash-6M2IVL1J.js";import"./log-out-CPWz0abV.js";import"./lock-open-BXtPEHre.js";import"./mail-DbGZhtgd.js";import"./monitor-8f8kIlma.js";import"./play-C30RTz1Z.js";import"./pen-DY3Fb26x.js";import"./user-Cidhjdlr.js";import"./trophy-xBHI5HxL.js";import"./wifi-off-CuncZRhC.js";import"./rotate-ccw-uF93MR3R.js";import"./save-Dy9vvheN.js";import"./search-BDGJpxHy.js";import"./shield-alert-DOWk1i5L.js";import"./smartphone-D81Slruk.js";import"./square-check-big-dwW8C68g.js";import"./square-lZ11Ib2v.js";import"./star-Bem72FV2.js";import"./sun-BQlunvnj.js";import"./target-BIkWigeX.js";import"./toggle-left-UXIPCGM9.js";import"./toggle-right-Bb3Hqrl1.js";import"./triangle-alert-2A0dCFLU.js";import"./upload-BCdVV1xp.js";import"./zoom-in-B__wRO_I.js";const Be=({isOpen:j,onClose:f,editTransactionId:o=null,onDelete:L,initialType:b="expense"})=>{ee(j);const{addTransaction:B,addTransfer:u,editTransaction:x,deleteTransaction:v,checkDuplicate:I,categories:y,accounts:N,transactions:c,addRecurringRule:n,getBudgetStats:w}=te(),{user:h}=ie(),[A,M]=i.useState(""),[g,s]=i.useState(b),[r,D]=i.useState(""),[m,$]=i.useState(""),[E,U]=i.useState(""),[G,T]=i.useState(""),[R,_]=i.useState(F(new Date,"yyyy-MM-dd")),[J,W]=i.useState(!1),[ae,X]=i.useState(null),[a,l]=i.useState(""),[C,d]=i.useState(!1),{showToast:O}=se();i.useEffect(()=>{j&&!o&&s(b)},[j,b,o]),i.useEffect(()=>{!o&&h&&ne.getDocument(`users/${h.uid}/config`,"ui").then(t=>{t&&t.lastUsedAccountId&&N.some(S=>S.id===t.lastUsedAccountId)&&$(t.lastUsedAccountId)})},[N,o,h]),i.useEffect(()=>{if(o){const t=c.find(S=>S.transactionId===o||S.id===o);t&&(M(t.amount.toString()),s(t.type),$(t.accountId||""),t.type==="transfer"?U(t.toAccountId||""):D(t.categoryId||""),T(t.description||t.note||""),t.date&&_(F(new Date(t.date),"yyyy-MM-dd")))}},[o,c]);const H=t=>M(t.toString()),Y=async t=>{t&&t.preventDefault();const S=Number(A);if(!A||isNaN(S)||S<=0){l("Please enter a valid amount");return}if(S>9999999){l("Amount cannot exceed â‚¹99,99,999");return}l("");const V={amount:S,type:g,note:G,date:new Date(R).toISOString()};try{if(g==="transfer"){if(!m||!E||m===E){l("Select valid source and destination accounts");return}o?await x(o,{...V,fromAccountId:m,toAccountId:E}):await u({...V,fromAccountId:m,toAccountId:E})}else{if(!r||!m){l("Please select a category and account");return}o?await x(o,{...V,categoryId:r,accountId:m}):await B({...V,categoryId:r,accountId:m,mode:"manual"}),h&&ne.setItem(`users/${h.uid}/config`,"ui",{lastUsedAccountId:m},!0)}O(o?"Transaction updated":"Transaction recorded","success"),f()}catch(le){console.error("Transaction failed:",le),O(le.message||"Failed to save. Try again.","error")}},p=N.filter(t=>!t.isArchived),z=g==="income"?y.filter(t=>t.type==="income"):g==="savings"?y.filter(t=>t.type==="savings"):y.filter(t=>t.type==="expense");return e.jsxs(q,{children:[j&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center pointer-events-none",children:[e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f,className:"absolute inset-0 bg-slate-950/40 backdrop-blur-md pointer-events-auto"}),e.jsxs(k.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-t-[2.5rem] sm:rounded-[2.5rem] shadow-2xl pointer-events-auto relative max-h-[92vh] flex flex-col overflow-hidden border border-white/20 dark:border-slate-800",children:[e.jsxs("div",{className:"p-8 pb-0 shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl flex items-center justify-center",children:g==="expense"?e.jsx(we,{className:"w-6 h-6 text-indigo-500"}):g==="income"?e.jsx(re,{className:"w-6 h-6 text-indigo-500"}):g==="savings"?e.jsx(ye,{className:"w-6 h-6 text-indigo-500"}):e.jsx(Ce,{className:"w-6 h-6 text-indigo-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-black text-slate-900 dark:text-white uppercase tracking-tight",children:o?"Edit Entry":"New Record"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:"Finance Center"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-indigo-500/30"}),e.jsx("p",{className:"text-[10px] text-indigo-500 font-black uppercase tracking-widest",children:g})]})]})]}),e.jsx(P,{variant:"exit",onClick:f,size:"sm"})]}),e.jsx("div",{className:"flex p-1 bg-slate-100 dark:bg-slate-800/10 rounded-2xl mb-8",children:["income","expense","savings"].map(t=>e.jsx("button",{type:"button",onClick:()=>s(t),className:`flex-1 py-3 text-[10px] font-black uppercase tracking-widest rounded-xl transition-all ${g===t?"bg-white dark:bg-slate-700 shadow-lg text-indigo-600 dark:text-indigo-400":"text-slate-400 hover:text-slate-600"}`,children:t},t))}),e.jsxs("div",{className:"text-center mb-10",children:[e.jsxs("div",{className:"inline-flex items-baseline gap-2",children:[e.jsx("span",{className:"text-4xl font-black text-slate-300 dark:text-slate-700",children:"â‚¹"}),e.jsx("input",{type:"number",inputMode:"decimal",value:A,onChange:t=>M(t.target.value),className:"bg-transparent border-none text-[72px] font-black text-slate-900 dark:text-white placeholder:text-slate-100 dark:placeholder:text-slate-800 focus:ring-0 p-0 w-full max-w-[280px] text-center leading-none",placeholder:"0",autoFocus:!0})]}),a&&e.jsx("p",{className:"text-rose-500 text-xs font-bold text-center mt-2",children:a})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-8 pb-8 space-y-6 scrollbar-hide",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g!=="transfer"&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Category"}),e.jsxs("div",{className:"relative group",children:[e.jsxs("select",{value:r,onChange:t=>D(t.target.value),className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500/30 rounded-2xl p-4 text-xs font-bold text-slate-900 dark:text-white appearance-none transition-all cursor-pointer",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Goal"}),z.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none opacity-40",children:e.jsx(re,{className:"w-4 h-4 rotate-90"})})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:g==="transfer"?"Source":"Account"}),e.jsxs("select",{value:m,onChange:t=>$(t.target.value),className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500/30 rounded-2xl p-4 text-xs font-bold text-slate-900 dark:text-white appearance-none transition-all cursor-pointer",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Wallet"}),p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),g==="transfer"&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Destination"}),e.jsxs("select",{value:E,onChange:t=>U(t.target.value),className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500/30 rounded-2xl p-4 text-xs font-bold text-slate-900 dark:text-white appearance-none transition-all cursor-pointer",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Target"}),p.filter(t=>t.id!==m).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Date"}),e.jsxs("button",{type:"button",onClick:()=>W(!0),className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500/30 rounded-2xl p-4 text-xs font-bold text-slate-900 dark:text-white flex items-center justify-between text-left transition-all",children:[e.jsx("span",{children:F(new Date(R+"T00:00:00"),"MMM dd, yyyy")}),e.jsx(de,{className:"w-4 h-4 text-slate-400"})]}),e.jsx(xe,{isOpen:J,onClose:()=>W(!1),initialDate:new Date(R+"T00:00:00"),onSelect:t=>{_(F(t,"yyyy-MM-dd")),W(!1)}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Reference"}),e.jsx("input",{type:"text",value:G,onChange:t=>T(t.target.value),placeholder:"Note...",className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500/30 rounded-2xl p-4 text-xs font-bold text-slate-900 dark:text-white placeholder:text-slate-400 focus:ring-0 transition-all"})]})]}),e.jsxs("div",{className:"pt-2",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1 mb-3 block",children:"Quick Add"}),e.jsx("div",{className:"flex gap-2 shrink-0",children:[100,500,1e3,2e3].map(t=>e.jsxs("button",{type:"button",onClick:()=>H(t),className:"px-5 py-2.5 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-xl text-[10px] font-black text-slate-600 dark:text-slate-400 hover:border-indigo-500 transition-all",children:["+ â‚¹",t]},t))})]})]}),e.jsx("div",{className:"p-8 pt-0 border-t border-slate-50 dark:border-slate-800/50",children:e.jsxs("div",{className:"flex gap-4 mt-6",children:[o&&e.jsx(P,{variant:"delete",onClick:()=>d(!0),className:"w-16 h-16",size:"lg"}),e.jsx(P,{variant:"primary",fullWidth:!0,onClick:Y,label:o?"Commit Changes":"Record Transaction",iconOnly:!0,className:"py-5",size:"lg",children:e.jsx("span",{className:"font-black uppercase text-xs tracking-[0.2em]",children:o?"Commit Changes":"Record Transaction"})})]})})]})]}),e.jsx(ke,{isOpen:C,onClose:()=>d(!1),onConfirm:()=>{L?L(o):v(o),f()},title:"Delete Transaction?",message:"Are you sure you want to erase this record from history? This action cannot be undone.",confirmText:"Erase"})]})},Ie=({isOpen:j,onClose:f})=>{const{categories:o,getBudgetStats:L,updateCategoryBudget:b,addCategory:B}=te(),[u,x]=i.useState(!1),[v,I]=i.useState({}),[y,N]=i.useState(!1),[c,n]=i.useState("");ee(j);const{showToast:w}=se();if(!j)return null;const h=o.filter(s=>s.type==="expense").map(s=>({...s,stats:L(s.id)})).sort((s,r)=>(r.stats?.percent||0)-(s.stats?.percent||0)),A=()=>{const s={};h.forEach(r=>{s[r.id]=r.budget||0}),I(s),x(!0)},M=async()=>{try{for(const s in v)await b(s,Number(v[s]));w("Budgets updated","success"),x(!1)}catch(s){console.error("Failed to save budgets:",s),w("Error saving budgets. Please try again.","error")}},g=async()=>{if(c.trim())try{await B({name:c,type:"expense",budget:0,color:"bg-indigo-500",icon:"IndianRupee"}),w("Category added","success"),n(""),N(!1)}catch(s){console.error("Failed to add category:",s)}};return e.jsxs("div",{className:"fixed inset-0 z-[200] flex items-end sm:items-center justify-center pointer-events-none",children:[e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-slate-950/60 backdrop-blur-md pointer-events-auto",onClick:f}),e.jsxs(k.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-t-[2.5rem] sm:rounded-[2.5rem] p-6 sm:p-8 shadow-2xl relative max-h-[92vh] overflow-hidden flex flex-col border border-white/10 pointer-events-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl flex items-center justify-center",children:e.jsx(Q,{className:"w-6 h-6 text-indigo-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-900 dark:text-white uppercase tracking-tight",children:"Budgets"}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:u?"Allocation Mode":"Monthly Summary"})]})]}),e.jsx("button",{onClick:f,className:"p-2.5 bg-slate-50 dark:bg-slate-800 rounded-full text-slate-500 hover:rotate-90 transition-transform",children:e.jsx(oe,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"overflow-y-auto flex-1 space-y-4 pr-1 scrollbar-hide pb-6",children:e.jsx(q,{mode:"wait",children:u?e.jsxs(k.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-4",children:[h.map(s=>e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/40 p-4 rounded-2xl flex items-center justify-between border border-white/5 group hover:border-indigo-500/30 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center text-[10px] font-black ${s.color} text-white`,children:s.name[0]}),e.jsx("span",{className:"font-black text-slate-700 dark:text-slate-200 text-xs uppercase tracking-tight",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white dark:bg-slate-900 px-3 py-2 rounded-xl border border-white/5 shadow-sm shrink-0",children:[e.jsx("span",{className:"text-slate-300 font-black text-[10px]",children:"â‚¹"}),e.jsx("input",{type:"number",value:v[s.id],onChange:r=>I({...v,[s.id]:r.target.value}),className:"w-24 bg-transparent border-none p-0 text-xs font-black text-slate-900 dark:text-white focus:ring-0 text-right",placeholder:"0"})]})]},s.id)),y?e.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-indigo-50 dark:bg-indigo-900/10 p-4 rounded-2xl border border-indigo-200 dark:border-indigo-900/30",children:[e.jsx("input",{type:"text",value:c,onChange:s=>n(s.target.value),placeholder:"Enter Label...",className:"w-full bg-transparent border-none p-0 mb-3 text-sm font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-widest placeholder:opacity-40 focus:ring-0",autoFocus:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 bg-white dark:bg-slate-800 text-slate-400 font-bold text-[10px] uppercase rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:g,className:"flex-1 py-2 bg-indigo-600 text-white font-black text-[10px] uppercase rounded-lg",children:"Confirm Label"})]})]}):e.jsx("button",{onClick:()=>N(!0),className:"w-full py-4 border-2 border-dashed border-slate-100 dark:border-slate-800 text-slate-400 font-black text-[10px] uppercase tracking-widest rounded-2xl hover:border-indigo-500/30 hover:text-indigo-500 transition-all",children:"+ New Spend Label"})]},"allocate"):e.jsxs(k.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"space-y-4",children:[h.filter(s=>Number(s.budget)>0).map(s=>{const{stats:r}=s,D=r.status==="danger",m=r.status==="warning";return e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/40 p-6 rounded-[2rem] border border-white/5 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center text-sm ${s.color} text-white font-black`,children:s.name[0]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-slate-900 dark:text-white text-[15px]",children:s.name}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest mt-0.5",children:["Limit: â‚¹",r.budget.toLocaleString()]})]})]}),e.jsxs("div",{className:`px-3 py-1.5 rounded-xl text-[10px] font-black uppercase tracking-tighter ${D?"bg-rose-50 dark:bg-rose-900/20 text-rose-600":m?"bg-orange-50 dark:bg-orange-900/20 text-orange-600":"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600"}`,children:[r.percent,"%"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-slate-200 dark:bg-slate-700/50 rounded-full overflow-hidden mb-5",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-700 ease-out ${D?"bg-rose-500":m?"bg-orange-500":"bg-emerald-500"}`,style:{width:`${Math.min(r.percent,100)}%`}})}),e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest",children:[e.jsxs("span",{className:"text-slate-400",children:["Spent â‚¹",r.spent.toLocaleString()]}),e.jsx("span",{className:D?"text-rose-500":"text-emerald-500",children:r.remaining>=0?`Left â‚¹${r.remaining.toLocaleString()}`:`Over â‚¹${Math.abs(r.remaining).toLocaleString()}`})]})]},s.id)}),h.filter(s=>Number(s.budget)>0).length===0&&e.jsxs("div",{className:"text-center py-20 bg-slate-50 dark:bg-slate-800/20 rounded-[2.5rem] border border-dashed border-slate-200 dark:border-slate-800",children:[e.jsx(Q,{className:"w-12 h-12 text-slate-200 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400 text-sm font-bold",children:"No active budgets found."}),e.jsx("button",{onClick:A,className:"mt-4 text-indigo-500 font-black uppercase text-[10px] tracking-widest",children:"+ Start Allocating"})]})]},"summary")})}),e.jsx("div",{className:"pt-6 shrink-0 bg-white dark:bg-slate-900",children:u?e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsx("button",{onClick:()=>x(!1),className:"py-5 bg-slate-100 dark:bg-slate-800 text-slate-500 font-black uppercase text-[10px] tracking-[0.1em] rounded-2xl active:scale-[0.98] transition-all",children:"Discard"}),e.jsxs("button",{onClick:async()=>{await M(),f()},className:"py-5 bg-indigo-600 text-white font-black uppercase text-[10px] tracking-[0.1em] rounded-2xl shadow-lg shadow-indigo-500/20 active:scale-[0.98] transition-all flex items-center justify-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Commit"]})]}):e.jsxs("button",{onClick:A,className:"w-full py-5 bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-black uppercase text-[10px] tracking-[0.2em] rounded-2xl shadow-xl active:scale-[0.98] transition-all flex items-center justify-center gap-2 mb-3",children:[e.jsx(Se,{className:"w-4 h-4"}),"Edit Budget Limits"]})})]})]})},$e=({isOpen:j,onClose:f,monthStats:o,categories:L,selectedDate:b})=>{const B=ce();ee(j);const{income:u,expense:x,transactions:v}=o||{income:0,expense:0,transactions:[]},y=v.filter(c=>c.type==="expense").reduce((c,n)=>{const w=n.categoryId||"uncategorized";return c[w]=(c[w]||0)+Number(n.amount),c},{}),N=Object.keys(y).map(c=>({id:c,amount:y[c]})).sort((c,n)=>n.amount-c.amount);return e.jsx(q,{children:j&&e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-end sm:items-center justify-center pointer-events-none",children:[e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm pointer-events-auto",onClick:f}),e.jsxs(k.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-t-[2rem] sm:rounded-[2rem] p-6 sm:p-8 shadow-2xl pointer-events-auto relative max-h-[90vh] overflow-y-auto pb-[calc(env(safe-area-inset-bottom,20px)+1.5rem)] scrollbar-hide",children:[e.jsx("div",{className:"w-12 h-1.5 bg-slate-200 dark:bg-slate-800 rounded-full mx-auto mb-6 sm:hidden"}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Analytics"}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:F(b||new Date,"MMMM yyyy")})]}),e.jsx("button",{onClick:f,className:"p-2 bg-slate-50 dark:bg-slate-800 rounded-full text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:e.jsx(oe,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-[1.5rem] p-5 mb-8 border border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-4",children:"Cash Flow"}),e.jsxs("div",{className:"flex justify-between text-sm mb-2 font-bold",children:[e.jsxs("span",{className:"text-emerald-500",children:["â‚¹",u.toLocaleString()," In"]}),e.jsxs("span",{className:"text-rose-500",children:["â‚¹",x.toLocaleString()," Out"]})]}),u+x>0?e.jsxs("div",{className:"h-3 w-full bg-slate-200 dark:bg-slate-800 rounded-full flex overflow-hidden",children:[e.jsx("div",{className:"bg-emerald-500 h-full",style:{width:`${u/(u+x)*100}%`}}),e.jsx("div",{className:"bg-rose-500 h-full",style:{width:`${x/(u+x)*100}%`}})]}):e.jsx("div",{className:"h-3 w-full bg-slate-200 dark:bg-slate-800 rounded-full flex overflow-hidden"}),e.jsx("p",{className:"text-xs text-slate-500 mt-4 text-center",children:u>=x&&u>0?e.jsxs("span",{className:"flex items-center justify-center gap-1.5 text-emerald-600 dark:text-emerald-400 font-bold",children:[e.jsx(K,{className:"w-4 h-4"})," Net Positive"]}):x>u?e.jsxs("span",{className:"flex items-center justify-center gap-1.5 text-rose-600 dark:text-rose-400 font-bold",children:[e.jsx(Ae,{className:"w-4 h-4"})," Net Negative"]}):e.jsx("span",{className:"flex items-center justify-center gap-1.5 text-slate-500 font-bold",children:"No Activity"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-4",children:"Top Expenses"}),N.length>0?e.jsx("div",{className:"space-y-5",children:N.map(c=>{const n=L?.find(h=>h.id===c.id),w=Math.round(c.amount/x*100)||0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-lg ${n?.color?n.color+"/10":"bg-slate-100 dark:bg-slate-800"} ${n?.color?.replace("bg-","text-")||"text-slate-500"}`,children:[n?.icon==="Utensils"&&"ðŸ½ï¸",n?.icon==="Bus"&&"ðŸšŒ",n?.icon==="ShoppingBag"&&"ðŸ›ï¸",n?.icon==="Zap"&&"âš¡",n?.icon==="IndianRupee"&&"â‚¹",!n?.icon&&(n?.name?.[0]||"?")]}),e.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:n?.name||"Uncategorized"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white",children:e.jsxs("span",{dir:"ltr",children:["â‚¹",c.amount.toLocaleString()]})}),e.jsxs("p",{className:"text-xs font-medium text-slate-500",children:[w,"%"]})]})]}),e.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${n?.color||"bg-slate-400"}`,style:{width:`${w}%`}})})]},c.id)})}):e.jsxs("div",{className:"text-center py-10 bg-slate-50 dark:bg-slate-800/50 rounded-[1.5rem] border border-slate-100 dark:border-slate-800",children:[e.jsx(Q,{className:"w-10 h-10 text-slate-300 dark:text-slate-700 mx-auto mb-3"}),e.jsx("p",{className:"text-sm font-bold text-slate-500",children:"No expenses this month"})]})]}),e.jsx("div",{className:"mt-10",children:e.jsx("button",{onClick:()=>{f(),B("/analytics")},className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-[1.25rem] font-black text-sm uppercase tracking-widest shadow-xl shadow-indigo-600/20 active:scale-95 transition-all",children:"Detailed Analytics Report"})})]})]})})},Qt=()=>{const j=ce(),{isDark:f}=pe(),{timeFormat:o}=ue(),{user:L}=ie();Me(f?"#0f172a":"#f8fafc");const{t:b}=he(),{getTotalBalance:B,categories:u,transactions:x,accounts:v,subscriptions:I,deleteTransaction:y,restoreTransaction:N}=te(),[c,n]=i.useState(!1),[w,h]=i.useState("expense"),[A,M]=i.useState(!1),[g,s]=i.useState(null),[r,D]=i.useState(new Date),[m,$]=i.useState(null),[E,U]=i.useState(!1),{showToast:G}=se(),T=i.useMemo(()=>{const a=ge(r),l=be(r),C=x.filter(p=>!p.isDeleted&&fe(new Date(p.date||p.createdAt),{start:a,end:l})),d=C.filter(p=>p.type==="income").reduce((p,z)=>p+Number(z.amount),0),O=C.filter(p=>p.type==="expense").reduce((p,z)=>p+Number(z.amount),0),H=C.filter(p=>p.type==="savings").reduce((p,z)=>p+Number(z.amount),0),Y=d>0?Math.round(H/d*100):0;return{transactions:C,income:d,expense:O,savings:H,savingsRate:Y}},[r,x]),R=a=>{D(l=>a>0?Ne(l,1):Le(l))},_=()=>{m&&(N(m.id),$(null))},J=a=>{s(a),n(!0)},W=B();v.filter(a=>!a.isArchived);const ae=i.useMemo(()=>I.filter(a=>a.status==="active").reduce((a,l)=>a+Number(l.amount),0),[I]),X=[...T.transactions].sort((a,l)=>new Date(l.date||l.createdAt)-new Date(a.date||a.createdAt));return e.jsx(je,{bottomNav:e.jsx(De,{}),renderFloating:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed right-6 z-40",style:{bottom:"calc(env(safe-area-inset-bottom, 0px) + 100px)"},children:e.jsx("button",{onClick:()=>{s(null),h("expense"),n(!0)},className:"w-14 h-14 bg-indigo-600 text-white rounded-full shadow-xl shadow-indigo-600/30 flex items-center justify-center active:scale-95 transition-transform",children:e.jsx(Te,{className:"w-6 h-6"})})}),c&&e.jsx(Be,{isOpen:!0,onClose:()=>n(!1),editTransactionId:g,initialType:w,onDelete:a=>{y(a),$({id:a,message:"Transaction deleted."}),setTimeout(()=>$(null),4e3)}}),e.jsx(Ie,{isOpen:A,onClose:()=>M(!1)}),e.jsx(q,{children:m&&e.jsxs(k.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"fixed left-1/2 -translate-x-1/2 z-50 bg-slate-900 text-white px-6 py-4 rounded-full shadow-2xl flex items-center gap-4 text-sm font-medium border border-white/10",style:{bottom:"calc(env(safe-area-inset-bottom, 0px) + 90px)"},children:[e.jsx("span",{children:m.message}),e.jsx(P,{variant:"undo",onClick:_,label:b("finance.undo","Undo"),iconOnly:!1,size:"sm",className:"bg-white/10 text-white hover:bg-white/20"})]})}),e.jsx($e,{isOpen:E,onClose:()=>U(!1),monthStats:T,categories:u,selectedDate:r})]}),title:b("finance.title","Finance"),rightNode:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex items-center gap-1 bg-slate-100 dark:bg-slate-900 rounded-2xl p-1 border border-slate-200 dark:border-slate-800",children:[e.jsx(P,{variant:"prev",onClick:()=>R(-1),size:"sm",className:"bg-transparent hover:bg-white dark:hover:bg-slate-800"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest min-w-[70px] text-center text-slate-700 dark:text-slate-200",children:F(r,"MMM yy")}),e.jsx(P,{variant:"forward",onClick:()=>R(1),size:"sm",className:"bg-transparent hover:bg-white dark:hover:bg-slate-800"})]})}),children:e.jsxs("div",{className:"flex flex-col space-y-6",children:[e.jsxs(k.div,{whileTap:{scale:.98},className:"bg-gradient-to-br from-indigo-500 to-indigo-600 dark:from-indigo-600 dark:to-indigo-800 rounded-[2.5rem] p-6 text-white shadow-2xl shadow-indigo-500/30 relative overflow-hidden",children:[e.jsx("div",{className:"absolute -top-12 -right-12 w-40 h-40 bg-white/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-12 -left-12 w-40 h-40 bg-black/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"mb-4 w-full flex flex-col items-center",children:e.jsxs("div",{className:"space-y-1 flex flex-col items-center",children:[e.jsx("p",{className:"text-indigo-100/70 text-[10px] font-black uppercase tracking-[0.2em]",children:b("finance.total_balance","Total Balance")}),e.jsxs("h2",{className:"text-[44px] sm:text-[48px] font-black tracking-tightest leading-tight flex items-center justify-center gap-1.5",children:[e.jsx("span",{className:"text-2xl opacity-40 font-bold",children:"â‚¹"}),e.jsx("span",{dir:"ltr",children:W.toLocaleString()})]})]})}),e.jsx("div",{className:"w-full h-px bg-white/10 mb-5"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-x-2.5 gap-y-2 w-full mb-5 max-w-[90%] mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-1.5 font-bold text-[10px] min-[380px]:text-[11px] tracking-tight",children:[e.jsx("span",{className:"text-emerald-300 uppercase tracking-wider",children:"Income"}),e.jsxs("span",{className:"text-white",children:["â‚¹",T.income.toLocaleString()]})]}),e.jsx("span",{className:"text-white/20 select-none text-[10px] hidden min-[360px]:block",children:"|"}),e.jsxs("div",{className:"flex items-center gap-1.5 font-bold text-[10px] min-[380px]:text-[11px] tracking-tight",children:[e.jsx("span",{className:"text-rose-300 uppercase tracking-wider",children:"Expense"}),e.jsxs("span",{className:"text-white",children:["â‚¹",T.expense.toLocaleString()]})]}),e.jsx("span",{className:"text-white/20 select-none text-[10px] hidden min-[360px]:block",children:"|"}),e.jsxs("div",{className:"flex items-center gap-1.5 font-bold text-[10px] min-[380px]:text-[11px] tracking-tight",children:[e.jsx("span",{className:"text-slate-300 uppercase tracking-wider",children:"Recurring"}),e.jsxs("span",{className:"text-white",children:["â‚¹",ae.toLocaleString()]})]})]}),e.jsx("div",{className:"flex justify-center w-full",children:e.jsxs("button",{onClick:a=>{a.stopPropagation(),s(null),h("savings"),n(!0)},className:"px-5 py-2 rounded-full border border-white/20 bg-transparent hover:bg-white/10 active:scale-95 transition-all text-[10px] font-black tracking-widest uppercase text-white flex items-center gap-2 shadow-sm",children:[e.jsx("span",{children:"Savings"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-white/30"}),e.jsxs("span",{className:"text-teal-300 tracking-tight",children:["â‚¹",T.savings.toLocaleString()]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(Z,{onClick:()=>U(!0),scaleDown:.96,className:"flex items-center gap-3 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-2xl px-4 py-3.5 shadow-sm w-full text-left",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl bg-emerald-50 dark:bg-emerald-900/20 flex items-center justify-center shrink-0",children:e.jsx(Q,{className:"w-[18px] h-[18px] text-emerald-500",strokeWidth:2.5})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[13px] font-bold text-slate-900 dark:text-white leading-tight",children:"Analytics"}),e.jsx("p",{className:"text-[10px] text-slate-400 font-medium",children:"Spending insights"})]})]}),e.jsxs(Z,{onClick:()=>M(!0),scaleDown:.96,className:"flex items-center gap-3 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-2xl px-4 py-3.5 shadow-sm w-full text-left",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl bg-rose-50 dark:bg-rose-900/20 flex items-center justify-center shrink-0",children:e.jsx(K,{className:"w-[18px] h-[18px] text-rose-500",strokeWidth:2.5})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[13px] font-bold text-slate-900 dark:text-white leading-tight",children:"Budget"}),e.jsx("p",{className:"text-[10px] text-slate-400 font-medium",children:"Category limits"})]})]})]}),e.jsxs("section",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white text-lg",children:b("finance.transactions","Transactions")}),e.jsx("button",{onClick:()=>j("/finance/monthly"),className:"text-slate-400 text-sm font-medium hover:text-indigo-500 transition-colors",children:"View all"})]}),e.jsx("div",{className:"space-y-3",children:X.length===0?e.jsxs("div",{className:"text-center py-12 px-6 bg-white dark:bg-slate-900 rounded-3xl border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-50 dark:bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(K,{className:"w-8 h-8 text-slate-300"})}),e.jsx("p",{className:"text-slate-900 dark:text-white font-bold mb-1",children:b("finance.no_expenses","No expenses yet")}),e.jsx("p",{className:"text-slate-500 text-sm mb-6 max-w-[200px] mx-auto",children:b("finance.start_tracking","Start tracking where your money goes.")}),e.jsx(Z,{onClick:()=>{s(null),h("expense"),n(!0)},scaleDown:.96,className:"bg-indigo-50 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400 px-6 py-2.5 rounded-xl font-bold transition-all text-sm inline-block",children:b("finance.add_first_record","+ Add Record")})]}):X.map(a=>{const l=u.find(d=>d.id===a.categoryId),C=a.type==="income";return e.jsx(Z,{onClick:()=>J(a.id),scaleDown:.98,className:"relative flex items-center justify-between bg-white dark:bg-slate-900 p-4 rounded-[1.25rem] border border-slate-100 dark:border-slate-800 transition-all cursor-pointer overflow-hidden w-full text-left",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10 w-full",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-xl shrink-0 ${l?.color?l.color+"/10":"bg-slate-50 dark:bg-slate-800"} ${l?.color?.replace("bg-","text-")||"text-slate-500"}`,children:(()=>{let d=l?.icon;d||(l?.name==="Food & Dining"?d="Utensils":l?.name==="Transport"?d="Bus":l?.name==="Shopping"?d="ShoppingBag":l?.name==="Bills & Utilities"?d="Zap":l?.name==="Salary"?d="IndianRupee":l?.name==="Savings Allocation"?d="Wallet":d="HelpCircle");const O=ve[d];return O?e.jsx(O,{className:"w-5 h-5 opacity-90"}):l?.name?.[0]||"?"})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-[15px] truncate",children:a.description||a.note||l?.name||"Transaction"}),e.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:[F(new Date(a.date||a.createdAt),o==="24h"?"dd MMM, HH:mm":"dd MMM, h:mm a")," â€¢ ",v.find(d=>d.id===a.accountId)?.name||"Account"]})]}),e.jsx("div",{className:"text-right shrink-0",children:e.jsxs("p",{className:`text-[16px] font-bold ${C?"text-emerald-500":"text-slate-900 dark:text-white"}`,children:[C?"+":"-",e.jsxs("span",{dir:"ltr",children:["â‚¹",Number(a.amount).toLocaleString()]})]})})]})},a.id)})})]})]})})};export{Qt as default};
