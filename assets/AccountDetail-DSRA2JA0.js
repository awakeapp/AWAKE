import{aA as Q,z as W,an as X,o as Z,r as n,j as e,V as _,aJ as ee,C as te,E as I,aj as se,T as ae,ah as ne}from"./index-9msspAXs.js";import{u as ie,S as re}from"./useSelection-Lbc3MKXR.js";import{I as E}from"./ItemMenu-VUnNMYsH.js";import{D as M}from"./DeleteConfirmationModal-C3Ect0Gz.js";import{A as oe}from"./archive-DkholNfQ.js";import{A as L}from"./arrow-right-left-BZqzp5zj.js";import{T as ce}from"./trending-up-kT6XmkFT.js";import{T as le}from"./trending-down-CdZPREFM.js";import"./square-check-big-dwW8C68g.js";import"./square-lZ11Ib2v.js";import"./eye-BqTX6Mm8.js";import"./pen-DY3Fb26x.js";import"./triangle-alert-2A0dCFLU.js";const ke=()=>{const{id:s}=Q(),u=W();X();const{accounts:h,transactions:j,updateAccount:B,toggleArchiveAccount:F,categories:P}=Z(),a=h.find(t=>t.id===s),[$,v]=n.useState(!1),[N,A]=n.useState(""),[y,k]=n.useState(""),[O,x]=n.useState(!1),[o,c]=n.useState([]),p=n.useRef(null),{isSelectionMode:f,selectedIds:C,toggleSelection:R,enterSelectionMode:U,exitSelectionMode:S,toggleSelectAll:H,selectedCount:z,isAllSelected:J}=ie(),g=n.useMemo(()=>a?j.filter(t=>t.accountId===s||t.fromAccountId===s||t.toAccountId===s).sort((t,l)=>new Date(l.date||l.createdAt)-new Date(t.date||t.createdAt)):[],[j,s,a]);if(!a)return e.jsx("div",{className:"p-6 text-center",children:"Account not found"});const T=()=>{A(a.name),k(a.openingBalance),v(!0)},V=()=>{B(s,{name:N,openingBalance:Number(y)}),v(!1),x(!1)},Y=()=>{o.forEach(t=>{}),c([]),S()},D=t=>{f||(p.current=setTimeout(()=>{navigator.vibrate&&navigator.vibrate(50),U(t)},500))},b=()=>{p.current&&clearTimeout(p.current)},[de,me]=n.useState(!1),q=()=>{F(s),u(-1)};return e.jsx(_,{headerBgClass:"bg-slate-900 text-white shadow-xl",headerBorderClass:"border-none",headerPadClass:"p-0",header:e.jsxs("div",{className:"contents",children:[e.jsx(re,{count:z,isAllSelected:J,onCancel:S,onSelectAll:()=>H(g.map(t=>t.id)),actions:[{label:"Delete",icon:e.jsx(ae,{className:"w-5 h-5"}),onClick:()=>c(Array.from(C)),variant:"danger"}]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>u(-1),className:"p-2 bg-transparent hover:bg-white/10 rounded-full transition-colors text-white -ml-2 focus:outline-none",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold text-white tracking-tight",children:"Account Detail"})]}),e.jsx(E,{dark:!0,onEdit:T,onDelete:()=>{},extraActions:[{label:a.isArchived?"Unarchive":"Archive",icon:oe,onClick:q}]})]}),e.jsx("div",{className:"text-center px-4 pb-8 pt-2",children:$?e.jsxs("div",{className:"space-y-3 max-w-xs mx-auto",children:[e.jsx("input",{value:N,onChange:t=>A(t.target.value),className:"bg-white/10 border border-white/20 rounded-lg p-2 text-center text-white font-bold w-full"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-slate-400 text-xs",children:"Opening: ₹"}),e.jsx("input",{type:"number",value:y,onChange:t=>k(t.target.value),className:"bg-white/10 border border-white/20 rounded-lg p-1 text-center text-white w-24"})]}),e.jsx("button",{onClick:()=>x(!0),className:"bg-emerald-500 text-white px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest",children:"Save Settings"})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-white/40 text-[9px] font-black uppercase tracking-[0.2em] mb-1",children:a.name}),e.jsxs("h2",{className:"text-4xl font-black tracking-tightest leading-tight",children:["₹",a.balance.toLocaleString()]}),e.jsx("button",{onClick:T,className:"text-[10px] font-bold text-indigo-300 hover:text-white uppercase tracking-wider mt-2",children:"Edit Account"})]})})]})]}),renderFloating:e.jsxs(e.Fragment,{children:[e.jsx(M,{isOpen:O,onClose:()=>x(!1),onConfirm:V,isFinancial:!0,title:"Confirm Changes?",message:"You are modifying financial account details. Are you sure you want to save these changes?",confirmLabel:"Save Changes"}),e.jsx(M,{isOpen:o.length>0,onClose:()=>c([]),onConfirm:Y,isFinancial:!0,title:o.length>1?`Delete ${o.length} Transactions?`:"Delete Transaction?",message:"Are you sure you want to delete these transactions? This will impact your account balance and history."})]}),children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-[2rem] p-6 shadow-sm border border-slate-100 dark:border-slate-800",children:[e.jsxs("h3",{className:"font-black text-[10px] uppercase tracking-widest text-slate-400 mb-6 flex items-center gap-2",children:[e.jsx(ee,{className:"w-3.5 h-3.5"}),"Transaction History"]}),e.jsx("div",{className:"space-y-5",children:g.length===0?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"No transactions found."})}):g.map(t=>{const l=t.type==="transfer";let i=!1,G=Number(t.amount),d=t.note,m=null;if(l)t.toAccountId===s?(i=!0,d=`Transfer from ${h.find(r=>r.id===t.fromAccountId)?.name}`,m=e.jsx(L,{className:"w-4 h-4 text-blue-500"})):(d=`Transfer to ${h.find(r=>r.id===t.toAccountId)?.name}`,m=e.jsx(L,{className:"w-4 h-4 text-slate-500"}));else{i=t.type==="income",t.type;const r=P.find(K=>K.id===t.categoryId);d=t.note||r?.name||"Transaction",m=i?e.jsx(ce,{className:"w-4 h-4 text-emerald-500"}):e.jsx(le,{className:"w-4 h-4 text-rose-500"})}const w=C.has(t.id);return e.jsxs("div",{onClick:()=>f&&R(t.id),onMouseDown:()=>D(t.id),onMouseUp:b,onMouseLeave:b,onTouchStart:()=>D(t.id),onTouchEnd:b,className:I("flex items-center justify-between border-b border-slate-50 dark:border-slate-800/50 pb-4 last:border-0 last:pb-0 transition-all cursor-pointer",w&&"bg-indigo-50/50 dark:bg-indigo-500/10 -mx-2 px-2 rounded-lg py-2 my-1"),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:I("w-10 h-10 rounded-full flex items-center justify-center shrink-0 transition-colors",w?"bg-indigo-600 text-white":"bg-slate-50 dark:bg-slate-800"),children:w?e.jsx(te,{className:"w-5 h-5"}):m}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-sm truncate uppercase tracking-tight",children:d}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-wider mt-0.5",children:se(new Date(t.date||t.createdAt),"MMM d, yyyy")})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:`font-black tracking-tight ${i?"text-emerald-500":"text-slate-900 dark:text-white"}`,children:[i?"+":"-","₹",G.toLocaleString()]}),!f&&e.jsx(E,{onEdit:()=>u(`/finance/transaction/${t.id}/edit`),onDelete:()=>c([t.id])})]})]},t.id)})})]})})})};export{ke as default};
