import{o as z,r as l,v as q,q as V,l as W,j as e,V as X,aR as B,C as Z,E as D,X as G,T as H,a1 as J}from"./index-DgPxFht0.js";import{u as K}from"./useThemeColor-C3OCr0DB.js";import{D as Q}from"./DeleteConfirmationModal-CadwlCts.js";import{I as Y}from"./ItemMenu-CxMDzUDN.js";import{u as ee,S as te}from"./useSelection-BZNpjxPS.js";import{F as se}from"./FinanceBottomNav-BKflvOf6.js";import{M as ae,B as le,S as re}from"./shopping-bag-C9fA3pQP.js";import{M as ne}from"./monitor-PjmbOiNw.js";import{S as oe}from"./smartphone-DGu3YEyP.js";import{C as ie}from"./credit-card-N7L52TBT.js";import{P as ce,a as de}from"./play-CmPrbfpg.js";import{d as xe}from"./differenceInDays-C6uvXbHI.js";import"./triangle-alert-BosfxxC0.js";import"./eye-C2e92q6p.js";import"./pen-D-4zrPxo.js";import"./square-check-big-CjtHy18m.js";import"./square-CRS1Gj_0.js";import"./book-open-C1SyAtjd.js";import"./wallet-BOyL5lfP.js";import"./ellipsis-DrznyRGW.js";const I=[{icon:B,label:"Utility"},{icon:ae,label:"Spotify"},{icon:ne,label:"Netflix"},{icon:oe,label:"Phone"},{icon:le,label:"Work"},{icon:re,label:"Shop"},{icon:ie,label:"Card"}],me=["from-indigo-500 to-purple-600","from-blue-500 to-cyan-500","from-emerald-500 to-teal-500","from-orange-500 to-red-500","from-pink-500 to-rose-500","from-slate-700 to-slate-900"],ue=()=>{const{subscriptions:o,addSubscription:A,deleteSubscription:j,toggleSubscriptionStatus:M}=z(),[u,i]=l.useState(!1),{t:m}=q(),{showToast:c}=V(),{selectedIds:k,isSelectionMode:r,toggleSelection:P,enterSelectionMode:T,exitSelectionMode:N,toggleSelectAll:$,count:p,isAllSelected:F}=ee(o.map(t=>t.id));W(u);const[g,v]=l.useState(""),[b,y]=l.useState(""),[f,w]=l.useState(""),[h,L]=l.useState(0),[S,O]=l.useState(0),[d,x]=l.useState(null),E=t=>{if(t.preventDefault(),!g||!b||!f)return;const s=Number(f);if(s<1||s>31){alert("Please enter a valid day (1-31)");return}try{A({name:g,amount:b,dueDate:s,iconIdx:h,colorIdx:S}),c("Subscription added","success"),i(!1),v(""),y(""),w("")}catch(n){console.error("Failed to save subscription:",n),c("Failed to save. Please try again.","error")}},R=t=>{const s=new Date,n=new Date(t),a=xe(n,s);return a<0?`Overdue ${Math.abs(a)}d`:a===0?"Due Today":a===1?"Tomorrow":`${a} days left`},C=[...o].sort((t,s)=>t.nextBillingDate?new Date(t.nextBillingDate)-new Date(s.nextBillingDate):0);o.filter(t=>t.status==="active").reduce((t,s)=>t+Number(s.amount),0);const U=async()=>{try{await Promise.all(k.map(t=>j(t))),c(`Deleted ${p} subscriptions`,"success"),N()}catch{c("Failed to delete some subscriptions","error")}finally{x(null)}};return e.jsx(X,{bottomNav:e.jsx(se,{}),title:r?void 0:m("finance.upcoming","Upcoming"),header:r?e.jsx(te,{count:p,onCancel:N,onSelectAll:$,isAllSelected:F,actions:e.jsx("button",{onClick:()=>x("bulk"),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 rounded-xl transition-colors",children:e.jsx(H,{className:"w-5 h-5"})})}):void 0,showBack:!r,rightNode:r?null:e.jsx("button",{onClick:()=>i(!0),className:"text-xs text-indigo-500 font-bold uppercase hover:bg-indigo-50 px-2 py-1 rounded-lg transition-colors",children:m("finance.add_new","+ Add New")}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"overflow-x-auto pb-4 -mx-4 px-4 scrollbar-hide flex gap-3",children:[C.length===0&&!u&&e.jsxs("div",{className:"w-full text-center py-6 border-2 border-dashed border-slate-200 dark:border-slate-800 rounded-2xl",children:[e.jsx("p",{className:"text-slate-400 text-sm mb-2",children:m("finance.no_upcoming_bills","No upcoming bills.")}),e.jsx("button",{onClick:()=>i(!0),className:"text-indigo-500 font-bold text-sm",children:m("finance.add_bill","+ Add Bill")})]}),C.map(t=>{const s=I[t.iconIdx||0].icon,n=R(t.nextBillingDate||t.dueDate),a=k.includes(t.id);return e.jsxs("div",{onClick:()=>r&&P(t.id),onContextMenu:_=>{_.preventDefault(),T(t.id)},className:D("min-w-[170px] max-w-[200px] p-5 rounded-[1.5rem] bg-white dark:bg-slate-900 border transition-all relative group flex flex-col justify-between min-h-[120px] gap-3 cursor-pointer",a?"border-indigo-500 ring-2 ring-indigo-500/20":"border-slate-100 dark:border-slate-800"),children:[e.jsx("div",{className:"absolute top-2 right-2 flex items-center gap-1 z-20",children:r?e.jsx("div",{className:D("w-5 h-5 rounded-full border flex items-center justify-center transition-colors",a?"bg-indigo-600 border-indigo-600":"border-slate-300 dark:border-slate-700"),children:a&&e.jsx(Z,{className:"w-3 h-3 text-white"})}):e.jsx(Y,{onEdit:()=>alert("Edit coming soon"),onDelete:()=>x(t.id),extraActions:[{label:t.status==="active"?"Pause":"Resume",icon:t.status==="active"?ce:de,onClick:()=>M(t.id)}]})}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl bg-indigo-50 dark:bg-indigo-900/20 flex items-center justify-center shrink-0",children:e.jsx(s,{className:"w-4 h-4 text-indigo-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-black text-slate-900 dark:text-white text-[11px] leading-tight truncate",children:t.name}),e.jsxs("p",{className:"text-slate-400 text-[11px] font-extrabold mt-0.5",children:["â‚¹",Number(t.amount).toLocaleString()]})]})]}),e.jsx("div",{className:`w-full text-center py-1 rounded-lg text-[8px] font-black uppercase tracking-widest ${t.status!=="active"?"bg-slate-100 dark:bg-slate-800 text-slate-400":n.includes("Overdue")?"bg-rose-50 dark:bg-rose-900/20 text-rose-500":"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600"}`,children:t.status==="active"?n:"Paused"})]},t.id)})]}),u&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-950/40 backdrop-blur-md",onClick:()=>i(!1)}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-t-[2.5rem] sm:rounded-[2.5rem] p-8 shadow-2xl relative z-10 max-h-[92vh] overflow-hidden flex flex-col border border-white/10 shrink-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl flex items-center justify-center",children:e.jsx(B,{className:"w-6 h-6 text-indigo-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-900 dark:text-white uppercase tracking-tight",children:"Recurring Bill"}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:"Subscription Manager"})]})]}),e.jsx("button",{onClick:()=>i(!1),className:"p-2.5 bg-slate-100 dark:bg-slate-800 rounded-full text-slate-500 hover:rotate-90 transition-transform",children:e.jsx(G,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6 overflow-y-auto pr-1 scrollbar-hide pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Name"}),e.jsx("input",{type:"text",value:g,onChange:t=>v(t.target.value),placeholder:"Spotify",className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500/30 rounded-2xl p-4 text-xs font-bold text-slate-900 dark:text-white placeholder:text-slate-400 focus:ring-0 transition-all",autoFocus:!0})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Amount"}),e.jsx("input",{type:"number",value:b,onChange:t=>y(t.target.value),placeholder:"0",className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500/30 rounded-2xl p-4 text-xs font-bold text-slate-900 dark:text-white placeholder:text-slate-400 focus:ring-0 transition-all text-right"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Due Day (1-31)"}),e.jsx("input",{type:"number",value:f,onChange:t=>w(t.target.value),placeholder:"15",min:"1",max:"31",className:"w-full bg-slate-50 dark:bg-slate-800/50 border-2 border-transparent focus:border-indigo-500/30 rounded-2xl p-4 text-xs font-bold text-slate-900 dark:text-white placeholder:text-slate-400 focus:ring-0 transition-all"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Visual Symbol"}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:I.map((t,s)=>e.jsx("button",{type:"button",onClick:()=>L(s),className:`aspect-square rounded-2xl flex items-center justify-center border-2 transition-all ${h===s?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-slate-50 dark:border-slate-800"}`,children:e.jsx(t.icon,{className:`w-5 h-5 ${h===s?"text-indigo-600":"text-slate-400"}`})},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[8px] font-black text-slate-400 uppercase tracking-[0.2em] ml-1",children:"Theme Palette"}),e.jsx("div",{className:"flex gap-4 pb-2",children:me.map((t,s)=>e.jsx("button",{type:"button",onClick:()=>O(s),className:`w-10 h-10 rounded-full bg-gradient-to-br ${t} ring-2 ring-offset-4 ring-offset-white dark:ring-offset-slate-900 transition-all ${S===s?"ring-indigo-500 scale-110":"ring-transparent opacity-60"}`},s))})]}),e.jsx("button",{type:"submit",className:"w-full bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-black uppercase text-xs tracking-[0.2em] py-5 rounded-2xl shadow-2xl active:scale-[0.98] transition-all flex items-center justify-center gap-2 mt-4",children:"Secure Subscription"})]})]})]}),e.jsx(Q,{isOpen:!!d,onClose:()=>x(null),onConfirm:d==="bulk"?U:()=>{j(d),c("Subscription deleted","info"),x(null)},title:d==="bulk"?`Delete ${p} Subscriptions?`:"Delete Subscription?",message:d==="bulk"?"Are you sure you want to delete these subscriptions? This action cannot be undone.":"Are you sure you want to delete this subscription? This cannot be undone."})]})})},$e=()=>{const{isDark:o}=J();return K(o?"#0f172a":"#f8fafc"),e.jsx(ue,{})};export{$e as default};
